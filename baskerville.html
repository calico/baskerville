

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>baskerville package &mdash; baskerville 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="baskerville.helpers package" href="baskerville.helpers.html" />
    <link rel="prev" title="baskerville documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            baskerville
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">baskerville package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html">baskerville.helpers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html">baskerville.scripts package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.adapters">baskerville.adapters module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.adapters.AdapterHoulsby"><code class="docutils literal notranslate"><span class="pre">AdapterHoulsby</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.AdapterHoulsby.build"><code class="docutils literal notranslate"><span class="pre">AdapterHoulsby.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.AdapterHoulsby.call"><code class="docutils literal notranslate"><span class="pre">AdapterHoulsby.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.AdapterHoulsby.get_config"><code class="docutils literal notranslate"><span class="pre">AdapterHoulsby.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.adapters.IA3"><code class="docutils literal notranslate"><span class="pre">IA3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.IA3.call"><code class="docutils literal notranslate"><span class="pre">IA3.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.IA3.get_config"><code class="docutils literal notranslate"><span class="pre">IA3.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.adapters.IA3_ff"><code class="docutils literal notranslate"><span class="pre">IA3_ff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.IA3_ff.call"><code class="docutils literal notranslate"><span class="pre">IA3_ff.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.IA3_ff.get_config"><code class="docutils literal notranslate"><span class="pre">IA3_ff.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.adapters.Locon"><code class="docutils literal notranslate"><span class="pre">Locon</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.Locon.call"><code class="docutils literal notranslate"><span class="pre">Locon.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.Locon.get_config"><code class="docutils literal notranslate"><span class="pre">Locon.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.adapters.Lora"><code class="docutils literal notranslate"><span class="pre">Lora</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.Lora.call"><code class="docutils literal notranslate"><span class="pre">Lora.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.adapters.Lora.get_config"><code class="docutils literal notranslate"><span class="pre">Lora.get_config()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.bed">baskerville.bed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.bed.make_bed_seqs"><code class="docutils literal notranslate"><span class="pre">make_bed_seqs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.bed.make_ntwise_bed_seqs"><code class="docutils literal notranslate"><span class="pre">make_ntwise_bed_seqs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.bed.read_bed_coords"><code class="docutils literal notranslate"><span class="pre">read_bed_coords()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.bed.write_bedgraph"><code class="docutils literal notranslate"><span class="pre">write_bedgraph()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.blocks">baskerville.blocks module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.center_average"><code class="docutils literal notranslate"><span class="pre">center_average()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.center_slice"><code class="docutils literal notranslate"><span class="pre">center_slice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.concat_dist_2d"><code class="docutils literal notranslate"><span class="pre">concat_dist_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.concat_position"><code class="docutils literal notranslate"><span class="pre">concat_position()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_block"><code class="docutils literal notranslate"><span class="pre">conv_block()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_block_2d"><code class="docutils literal notranslate"><span class="pre">conv_block_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_dna"><code class="docutils literal notranslate"><span class="pre">conv_dna()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_nac"><code class="docutils literal notranslate"><span class="pre">conv_nac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_next"><code class="docutils literal notranslate"><span class="pre">conv_next()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_tower"><code class="docutils literal notranslate"><span class="pre">conv_tower()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_tower_nac"><code class="docutils literal notranslate"><span class="pre">conv_tower_nac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.conv_tower_v1"><code class="docutils literal notranslate"><span class="pre">conv_tower_v1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.convnext_tower"><code class="docutils literal notranslate"><span class="pre">convnext_tower()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.cropping_2d"><code class="docutils literal notranslate"><span class="pre">cropping_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.dense_block"><code class="docutils literal notranslate"><span class="pre">dense_block()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.dense_nac"><code class="docutils literal notranslate"><span class="pre">dense_nac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.dilated_dense"><code class="docutils literal notranslate"><span class="pre">dilated_dense()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.dilated_residual"><code class="docutils literal notranslate"><span class="pre">dilated_residual()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.dilated_residual_2d"><code class="docutils literal notranslate"><span class="pre">dilated_residual_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.dilated_residual_nac"><code class="docutils literal notranslate"><span class="pre">dilated_residual_nac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.factor_inverse"><code class="docutils literal notranslate"><span class="pre">factor_inverse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.final"><code class="docutils literal notranslate"><span class="pre">final()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.global_context"><code class="docutils literal notranslate"><span class="pre">global_context()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.one_to_two"><code class="docutils literal notranslate"><span class="pre">one_to_two()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.res_tower"><code class="docutils literal notranslate"><span class="pre">res_tower()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.squeeze_excite"><code class="docutils literal notranslate"><span class="pre">squeeze_excite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.swin_transformer"><code class="docutils literal notranslate"><span class="pre">swin_transformer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.symmetrize_2d"><code class="docutils literal notranslate"><span class="pre">symmetrize_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.tconv_nac"><code class="docutils literal notranslate"><span class="pre">tconv_nac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.transformer"><code class="docutils literal notranslate"><span class="pre">transformer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.transformer2"><code class="docutils literal notranslate"><span class="pre">transformer2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.transformer_dense"><code class="docutils literal notranslate"><span class="pre">transformer_dense()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.transformer_split"><code class="docutils literal notranslate"><span class="pre">transformer_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.transformer_tower"><code class="docutils literal notranslate"><span class="pre">transformer_tower()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.unet_concat"><code class="docutils literal notranslate"><span class="pre">unet_concat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.unet_conv"><code class="docutils literal notranslate"><span class="pre">unet_conv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.upper_tri"><code class="docutils literal notranslate"><span class="pre">upper_tri()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.blocks.wheeze_excite"><code class="docutils literal notranslate"><span class="pre">wheeze_excite()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.data">baskerville.data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.Contig"><code class="docutils literal notranslate"><span class="pre">Contig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.Contig.chr"><code class="docutils literal notranslate"><span class="pre">Contig.chr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.Contig.end"><code class="docutils literal notranslate"><span class="pre">Contig.end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.Contig.genome"><code class="docutils literal notranslate"><span class="pre">Contig.genome</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.Contig.start"><code class="docutils literal notranslate"><span class="pre">Contig.start</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.ModelSeq"><code class="docutils literal notranslate"><span class="pre">ModelSeq</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.ModelSeq.chr"><code class="docutils literal notranslate"><span class="pre">ModelSeq.chr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.ModelSeq.end"><code class="docutils literal notranslate"><span class="pre">ModelSeq.end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.ModelSeq.genome"><code class="docutils literal notranslate"><span class="pre">ModelSeq.genome</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.ModelSeq.label"><code class="docutils literal notranslate"><span class="pre">ModelSeq.label</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.data.ModelSeq.start"><code class="docutils literal notranslate"><span class="pre">ModelSeq.start</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.annotate_unmap"><code class="docutils literal notranslate"><span class="pre">annotate_unmap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.break_large_contigs"><code class="docutils literal notranslate"><span class="pre">break_large_contigs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.contig_sequences"><code class="docutils literal notranslate"><span class="pre">contig_sequences()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.load_chromosomes"><code class="docutils literal notranslate"><span class="pre">load_chromosomes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.rejoin_large_contigs"><code class="docutils literal notranslate"><span class="pre">rejoin_large_contigs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.split_contigs"><code class="docutils literal notranslate"><span class="pre">split_contigs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.data.write_seqs_bed"><code class="docutils literal notranslate"><span class="pre">write_seqs_bed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.dataset">baskerville.dataset module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dataset.SeqDataset"><code class="docutils literal notranslate"><span class="pre">SeqDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.dataset.SeqDataset.batches_per_epoch"><code class="docutils literal notranslate"><span class="pre">SeqDataset.batches_per_epoch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.dataset.SeqDataset.compute_stats"><code class="docutils literal notranslate"><span class="pre">SeqDataset.compute_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.dataset.SeqDataset.distribute"><code class="docutils literal notranslate"><span class="pre">SeqDataset.distribute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.dataset.SeqDataset.generate_parser"><code class="docutils literal notranslate"><span class="pre">SeqDataset.generate_parser()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.dataset.SeqDataset.make_dataset"><code class="docutils literal notranslate"><span class="pre">SeqDataset.make_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.dataset.SeqDataset.numpy"><code class="docutils literal notranslate"><span class="pre">SeqDataset.numpy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dataset.file_to_records"><code class="docutils literal notranslate"><span class="pre">file_to_records()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dataset.make_strand_transform"><code class="docutils literal notranslate"><span class="pre">make_strand_transform()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dataset.targets_prep_strand"><code class="docutils literal notranslate"><span class="pre">targets_prep_strand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dataset.untransform_preds"><code class="docutils literal notranslate"><span class="pre">untransform_preds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dataset.untransform_preds1"><code class="docutils literal notranslate"><span class="pre">untransform_preds1()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.dna">baskerville.dna module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.dna_1hot"><code class="docutils literal notranslate"><span class="pre">dna_1hot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.dna_1hot_index"><code class="docutils literal notranslate"><span class="pre">dna_1hot_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.dna_rc"><code class="docutils literal notranslate"><span class="pre">dna_rc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.hot1_augment"><code class="docutils literal notranslate"><span class="pre">hot1_augment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.hot1_delete"><code class="docutils literal notranslate"><span class="pre">hot1_delete()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.hot1_dna"><code class="docutils literal notranslate"><span class="pre">hot1_dna()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.hot1_get"><code class="docutils literal notranslate"><span class="pre">hot1_get()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.hot1_insert"><code class="docutils literal notranslate"><span class="pre">hot1_insert()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.hot1_rc"><code class="docutils literal notranslate"><span class="pre">hot1_rc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.dna.hot1_set"><code class="docutils literal notranslate"><span class="pre">hot1_set()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.gene">baskerville.gene module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.gene.Gene"><code class="docutils literal notranslate"><span class="pre">Gene</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Gene.add_exon"><code class="docutils literal notranslate"><span class="pre">Gene.add_exon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Gene.get_exons"><code class="docutils literal notranslate"><span class="pre">Gene.get_exons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Gene.midpoint"><code class="docutils literal notranslate"><span class="pre">Gene.midpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Gene.output_slice"><code class="docutils literal notranslate"><span class="pre">Gene.output_slice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Gene.output_slice_old"><code class="docutils literal notranslate"><span class="pre">Gene.output_slice_old()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Gene.span"><code class="docutils literal notranslate"><span class="pre">Gene.span()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.gene.GenomicInterval"><code class="docutils literal notranslate"><span class="pre">GenomicInterval</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.gene.Transcriptome"><code class="docutils literal notranslate"><span class="pre">Transcriptome</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Transcriptome.bedtool_exon"><code class="docutils literal notranslate"><span class="pre">Transcriptome.bedtool_exon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Transcriptome.bedtool_span"><code class="docutils literal notranslate"><span class="pre">Transcriptome.bedtool_span()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Transcriptome.read_gtf"><code class="docutils literal notranslate"><span class="pre">Transcriptome.read_gtf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Transcriptome.write_bed_exon"><code class="docutils literal notranslate"><span class="pre">Transcriptome.write_bed_exon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.gene.Transcriptome.write_bed_span"><code class="docutils literal notranslate"><span class="pre">Transcriptome.write_bed_span()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.gene.gtf_kv"><code class="docutils literal notranslate"><span class="pre">gtf_kv()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.layers">baskerville.layers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.CenterAverage"><code class="docutils literal notranslate"><span class="pre">CenterAverage</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.CenterAverage.call"><code class="docutils literal notranslate"><span class="pre">CenterAverage.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.CenterAverage.get_config"><code class="docutils literal notranslate"><span class="pre">CenterAverage.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.CenterSlice"><code class="docutils literal notranslate"><span class="pre">CenterSlice</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.CenterSlice.call"><code class="docutils literal notranslate"><span class="pre">CenterSlice.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.CenterSlice.get_config"><code class="docutils literal notranslate"><span class="pre">CenterSlice.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.ConcatDist2D"><code class="docutils literal notranslate"><span class="pre">ConcatDist2D</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.ConcatDist2D.call"><code class="docutils literal notranslate"><span class="pre">ConcatDist2D.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.ConcatPosition"><code class="docutils literal notranslate"><span class="pre">ConcatPosition</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.ConcatPosition.call"><code class="docutils literal notranslate"><span class="pre">ConcatPosition.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.ConcatPosition.get_config"><code class="docutils literal notranslate"><span class="pre">ConcatPosition.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.EnsembleReverseComplement"><code class="docutils literal notranslate"><span class="pre">EnsembleReverseComplement</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.EnsembleReverseComplement.call"><code class="docutils literal notranslate"><span class="pre">EnsembleReverseComplement.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.EnsembleShift"><code class="docutils literal notranslate"><span class="pre">EnsembleShift</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.EnsembleShift.call"><code class="docutils literal notranslate"><span class="pre">EnsembleShift.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.EnsembleShift.get_config"><code class="docutils literal notranslate"><span class="pre">EnsembleShift.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.FactorInverse"><code class="docutils literal notranslate"><span class="pre">FactorInverse</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.FactorInverse.call"><code class="docutils literal notranslate"><span class="pre">FactorInverse.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.FactorInverse.get_config"><code class="docutils literal notranslate"><span class="pre">FactorInverse.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.GlobalContext"><code class="docutils literal notranslate"><span class="pre">GlobalContext</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.GlobalContext.build"><code class="docutils literal notranslate"><span class="pre">GlobalContext.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.GlobalContext.call"><code class="docutils literal notranslate"><span class="pre">GlobalContext.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.LengthAverage"><code class="docutils literal notranslate"><span class="pre">LengthAverage</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.LengthAverage.call"><code class="docutils literal notranslate"><span class="pre">LengthAverage.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.MultiheadAttention"><code class="docutils literal notranslate"><span class="pre">MultiheadAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.MultiheadAttention.call"><code class="docutils literal notranslate"><span class="pre">MultiheadAttention.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.MultiheadAttention.get_config"><code class="docutils literal notranslate"><span class="pre">MultiheadAttention.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.OneToTwo"><code class="docutils literal notranslate"><span class="pre">OneToTwo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.OneToTwo.call"><code class="docutils literal notranslate"><span class="pre">OneToTwo.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.OneToTwo.get_config"><code class="docutils literal notranslate"><span class="pre">OneToTwo.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.Scale"><code class="docutils literal notranslate"><span class="pre">Scale</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.Scale.build"><code class="docutils literal notranslate"><span class="pre">Scale.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.Scale.call"><code class="docutils literal notranslate"><span class="pre">Scale.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.Scale.get_config"><code class="docutils literal notranslate"><span class="pre">Scale.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.SoftmaxPool1D"><code class="docutils literal notranslate"><span class="pre">SoftmaxPool1D</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SoftmaxPool1D.build"><code class="docutils literal notranslate"><span class="pre">SoftmaxPool1D.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SoftmaxPool1D.call"><code class="docutils literal notranslate"><span class="pre">SoftmaxPool1D.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SoftmaxPool1D.get_config"><code class="docutils literal notranslate"><span class="pre">SoftmaxPool1D.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.Softplus"><code class="docutils literal notranslate"><span class="pre">Softplus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.Softplus.call"><code class="docutils literal notranslate"><span class="pre">Softplus.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.Softplus.get_config"><code class="docutils literal notranslate"><span class="pre">Softplus.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.SqueezeExcite"><code class="docutils literal notranslate"><span class="pre">SqueezeExcite</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SqueezeExcite.build"><code class="docutils literal notranslate"><span class="pre">SqueezeExcite.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SqueezeExcite.call"><code class="docutils literal notranslate"><span class="pre">SqueezeExcite.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SqueezeExcite.get_config"><code class="docutils literal notranslate"><span class="pre">SqueezeExcite.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.StochasticReverseComplement"><code class="docutils literal notranslate"><span class="pre">StochasticReverseComplement</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.StochasticReverseComplement.call"><code class="docutils literal notranslate"><span class="pre">StochasticReverseComplement.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.StochasticShift"><code class="docutils literal notranslate"><span class="pre">StochasticShift</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.StochasticShift.call"><code class="docutils literal notranslate"><span class="pre">StochasticShift.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.StochasticShift.get_config"><code class="docutils literal notranslate"><span class="pre">StochasticShift.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.SwitchReverse"><code class="docutils literal notranslate"><span class="pre">SwitchReverse</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SwitchReverse.call"><code class="docutils literal notranslate"><span class="pre">SwitchReverse.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SwitchReverse.get_config"><code class="docutils literal notranslate"><span class="pre">SwitchReverse.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.SwitchReverseTriu"><code class="docutils literal notranslate"><span class="pre">SwitchReverseTriu</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SwitchReverseTriu.call"><code class="docutils literal notranslate"><span class="pre">SwitchReverseTriu.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.SwitchReverseTriu.get_config"><code class="docutils literal notranslate"><span class="pre">SwitchReverseTriu.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.Symmetrize2D"><code class="docutils literal notranslate"><span class="pre">Symmetrize2D</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.Symmetrize2D.call"><code class="docutils literal notranslate"><span class="pre">Symmetrize2D.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.UpperTri"><code class="docutils literal notranslate"><span class="pre">UpperTri</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.UpperTri.call"><code class="docutils literal notranslate"><span class="pre">UpperTri.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.UpperTri.get_config"><code class="docutils literal notranslate"><span class="pre">UpperTri.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.WheezeExcite"><code class="docutils literal notranslate"><span class="pre">WheezeExcite</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.WheezeExcite.build"><code class="docutils literal notranslate"><span class="pre">WheezeExcite.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.WheezeExcite.call"><code class="docutils literal notranslate"><span class="pre">WheezeExcite.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.layers.WheezeExcite.get_config"><code class="docutils literal notranslate"><span class="pre">WheezeExcite.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.activate"><code class="docutils literal notranslate"><span class="pre">activate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.positional_features"><code class="docutils literal notranslate"><span class="pre">positional_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.positional_features_central_mask"><code class="docutils literal notranslate"><span class="pre">positional_features_central_mask()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.relative_shift"><code class="docutils literal notranslate"><span class="pre">relative_shift()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.layers.shift_sequence"><code class="docutils literal notranslate"><span class="pre">shift_sequence()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.metrics">baskerville.metrics module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.MeanSquaredErrorUDot"><code class="docutils literal notranslate"><span class="pre">MeanSquaredErrorUDot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.PearsonR"><code class="docutils literal notranslate"><span class="pre">PearsonR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.PearsonR.reset_state"><code class="docutils literal notranslate"><span class="pre">PearsonR.reset_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.PearsonR.result"><code class="docutils literal notranslate"><span class="pre">PearsonR.result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.PearsonR.update_state"><code class="docutils literal notranslate"><span class="pre">PearsonR.update_state()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.PoissonKL"><code class="docutils literal notranslate"><span class="pre">PoissonKL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.PoissonMultinomial"><code class="docutils literal notranslate"><span class="pre">PoissonMultinomial</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.R2"><code class="docutils literal notranslate"><span class="pre">R2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.R2.reset_state"><code class="docutils literal notranslate"><span class="pre">R2.reset_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.R2.result"><code class="docutils literal notranslate"><span class="pre">R2.result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.R2.update_state"><code class="docutils literal notranslate"><span class="pre">R2.update_state()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.SeqAUC"><code class="docutils literal notranslate"><span class="pre">SeqAUC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.SeqAUC.interpolate_pr_auc"><code class="docutils literal notranslate"><span class="pre">SeqAUC.interpolate_pr_auc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.SeqAUC.result"><code class="docutils literal notranslate"><span class="pre">SeqAUC.result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.metrics.SeqAUC.update_state"><code class="docutils literal notranslate"><span class="pre">SeqAUC.update_state()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.mean_squared_error_udot"><code class="docutils literal notranslate"><span class="pre">mean_squared_error_udot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.poisson"><code class="docutils literal notranslate"><span class="pre">poisson()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.poisson_kl"><code class="docutils literal notranslate"><span class="pre">poisson_kl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.metrics.poisson_multinomial"><code class="docutils literal notranslate"><span class="pre">poisson_multinomial()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.seqnn">baskerville.seqnn module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.seqnn.SeqNN"><code class="docutils literal notranslate"><span class="pre">SeqNN</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.append_activation"><code class="docutils literal notranslate"><span class="pre">SeqNN.append_activation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.build_block"><code class="docutils literal notranslate"><span class="pre">SeqNN.build_block()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.build_embed"><code class="docutils literal notranslate"><span class="pre">SeqNN.build_embed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.build_ensemble"><code class="docutils literal notranslate"><span class="pre">SeqNN.build_ensemble()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.build_model"><code class="docutils literal notranslate"><span class="pre">SeqNN.build_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.build_sad"><code class="docutils literal notranslate"><span class="pre">SeqNN.build_sad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.build_slice"><code class="docutils literal notranslate"><span class="pre">SeqNN.build_slice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.downcast"><code class="docutils literal notranslate"><span class="pre">SeqNN.downcast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.evaluate"><code class="docutils literal notranslate"><span class="pre">SeqNN.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.get_bn_layer"><code class="docutils literal notranslate"><span class="pre">SeqNN.get_bn_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.get_conv_layer"><code class="docutils literal notranslate"><span class="pre">SeqNN.get_conv_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.get_conv_weights"><code class="docutils literal notranslate"><span class="pre">SeqNN.get_conv_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.get_dense_layer"><code class="docutils literal notranslate"><span class="pre">SeqNN.get_dense_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.gradients"><code class="docutils literal notranslate"><span class="pre">SeqNN.gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.gradients_func"><code class="docutils literal notranslate"><span class="pre">SeqNN.gradients_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.insert_adapter"><code class="docutils literal notranslate"><span class="pre">SeqNN.insert_adapter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.num_targets"><code class="docutils literal notranslate"><span class="pre">SeqNN.num_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.predict"><code class="docutils literal notranslate"><span class="pre">SeqNN.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.predict_transform"><code class="docutils literal notranslate"><span class="pre">SeqNN.predict_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.restore"><code class="docutils literal notranslate"><span class="pre">SeqNN.restore()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.save"><code class="docutils literal notranslate"><span class="pre">SeqNN.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.set_defaults"><code class="docutils literal notranslate"><span class="pre">SeqNN.set_defaults()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.step"><code class="docutils literal notranslate"><span class="pre">SeqNN.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.seqnn.SeqNN.track_sequence"><code class="docutils literal notranslate"><span class="pre">SeqNN.track_sequence()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.snps">baskerville.snps module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.GeneSNPCluster"><code class="docutils literal notranslate"><span class="pre">GeneSNPCluster</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.snps.GeneSNPCluster.add_gene"><code class="docutils literal notranslate"><span class="pre">GeneSNPCluster.add_gene()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.snps.GeneSNPCluster.delimit"><code class="docutils literal notranslate"><span class="pre">GeneSNPCluster.delimit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.SNPCluster"><code class="docutils literal notranslate"><span class="pre">SNPCluster</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.snps.SNPCluster.add_snp"><code class="docutils literal notranslate"><span class="pre">SNPCluster.add_snp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.snps.SNPCluster.delimit"><code class="docutils literal notranslate"><span class="pre">SNPCluster.delimit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.snps.SNPCluster.get_1hots"><code class="docutils literal notranslate"><span class="pre">SNPCluster.get_1hots()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.cluster_genes"><code class="docutils literal notranslate"><span class="pre">cluster_genes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.cluster_snps"><code class="docutils literal notranslate"><span class="pre">cluster_snps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.compute_scores"><code class="docutils literal notranslate"><span class="pre">compute_scores()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.initialize_output_h5"><code class="docutils literal notranslate"><span class="pre">initialize_output_h5()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.make_alt_1hot"><code class="docutils literal notranslate"><span class="pre">make_alt_1hot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.make_gene_bedt"><code class="docutils literal notranslate"><span class="pre">make_gene_bedt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.make_snp_bedt"><code class="docutils literal notranslate"><span class="pre">make_snp_bedt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.map_snps_genes"><code class="docutils literal notranslate"><span class="pre">map_snps_genes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.score_gene_snps"><code class="docutils literal notranslate"><span class="pre">score_gene_snps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.score_snps"><code class="docutils literal notranslate"><span class="pre">score_snps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.stitch_preds"><code class="docutils literal notranslate"><span class="pre">stitch_preds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.write_pct"><code class="docutils literal notranslate"><span class="pre">write_pct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.snps.write_snp"><code class="docutils literal notranslate"><span class="pre">write_snp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.stream">baskerville.stream module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.stream.PredStreamGen"><code class="docutils literal notranslate"><span class="pre">PredStreamGen</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.stream.PredStreamGen.make_dataset"><code class="docutils literal notranslate"><span class="pre">PredStreamGen.make_dataset()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.trainer">baskerville.trainer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.CheckGradientNA"><code class="docutils literal notranslate"><span class="pre">CheckGradientNA()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.Cyclical1LearningRate"><code class="docutils literal notranslate"><span class="pre">Cyclical1LearningRate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.Cyclical1LearningRate.get_config"><code class="docutils literal notranslate"><span class="pre">Cyclical1LearningRate.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.EarlyStoppingMin"><code class="docutils literal notranslate"><span class="pre">EarlyStoppingMin</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.EarlyStoppingMin.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">EarlyStoppingMin.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.GPUMemoryUsageCallback"><code class="docutils literal notranslate"><span class="pre">GPUMemoryUsageCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.GPUMemoryUsageCallback.on_batch_end"><code class="docutils literal notranslate"><span class="pre">GPUMemoryUsageCallback.on_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.GPUMemoryUsageCallback.on_train_begin"><code class="docutils literal notranslate"><span class="pre">GPUMemoryUsageCallback.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.Trainer.compile"><code class="docutils literal notranslate"><span class="pre">Trainer.compile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.Trainer.fit2"><code class="docutils literal notranslate"><span class="pre">Trainer.fit2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.Trainer.fit_keras"><code class="docutils literal notranslate"><span class="pre">Trainer.fit_keras()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.Trainer.fit_tape"><code class="docutils literal notranslate"><span class="pre">Trainer.fit_tape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.Trainer.make_optimizer"><code class="docutils literal notranslate"><span class="pre">Trainer.make_optimizer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.WarmUp"><code class="docutils literal notranslate"><span class="pre">WarmUp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.trainer.WarmUp.get_config"><code class="docutils literal notranslate"><span class="pre">WarmUp.get_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.adaptive_clip_grad"><code class="docutils literal notranslate"><span class="pre">adaptive_clip_grad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.compute_norm"><code class="docutils literal notranslate"><span class="pre">compute_norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.parse_loss"><code class="docutils literal notranslate"><span class="pre">parse_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.safe_next"><code class="docutils literal notranslate"><span class="pre">safe_next()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.trainer.unitwise_norm"><code class="docutils literal notranslate"><span class="pre">unitwise_norm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.transfer">baskerville.transfer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.add_houlsby"><code class="docutils literal notranslate"><span class="pre">add_houlsby()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.add_houlsby_se"><code class="docutils literal notranslate"><span class="pre">add_houlsby_se()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.add_ia3"><code class="docutils literal notranslate"><span class="pre">add_ia3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.add_locon"><code class="docutils literal notranslate"><span class="pre">add_locon()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.add_lora"><code class="docutils literal notranslate"><span class="pre">add_lora()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.add_lora_conv"><code class="docutils literal notranslate"><span class="pre">add_lora_conv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.keras2dict"><code class="docutils literal notranslate"><span class="pre">keras2dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.locon_increment"><code class="docutils literal notranslate"><span class="pre">locon_increment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.lora_increment"><code class="docutils literal notranslate"><span class="pre">lora_increment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.merge_ia3"><code class="docutils literal notranslate"><span class="pre">merge_ia3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.merge_locon"><code class="docutils literal notranslate"><span class="pre">merge_locon()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.merge_lora"><code class="docutils literal notranslate"><span class="pre">merge_lora()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.merge_lora_layer"><code class="docutils literal notranslate"><span class="pre">merge_lora_layer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.modify_json"><code class="docutils literal notranslate"><span class="pre">modify_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.param_count"><code class="docutils literal notranslate"><span class="pre">param_count()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.param_summary"><code class="docutils literal notranslate"><span class="pre">param_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.transfer.var_reorder"><code class="docutils literal notranslate"><span class="pre">var_reorder()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville.vcf">baskerville.vcf module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.SNP"><code class="docutils literal notranslate"><span class="pre">SNP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.vcf.SNP.vcf_line"><code class="docutils literal notranslate"><span class="pre">SNP.vcf_line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.vcf.SNP.flip_alleles"><code class="docutils literal notranslate"><span class="pre">SNP.flip_alleles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.vcf.SNP.get_alleles"><code class="docutils literal notranslate"><span class="pre">SNP.get_alleles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.vcf.SNP.indel_size"><code class="docutils literal notranslate"><span class="pre">SNP.indel_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#baskerville.vcf.SNP.longest_alt"><code class="docutils literal notranslate"><span class="pre">SNP.longest_alt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.cap_allele"><code class="docutils literal notranslate"><span class="pre">cap_allele()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.dna_length_1hot"><code class="docutils literal notranslate"><span class="pre">dna_length_1hot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.intersect_seqs_snps"><code class="docutils literal notranslate"><span class="pre">intersect_seqs_snps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.intersect_snps_seqs"><code class="docutils literal notranslate"><span class="pre">intersect_snps_seqs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.snp_seq1"><code class="docutils literal notranslate"><span class="pre">snp_seq1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.snps2_seq1"><code class="docutils literal notranslate"><span class="pre">snps2_seq1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.snps_seq1"><code class="docutils literal notranslate"><span class="pre">snps_seq1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.vcf_count"><code class="docutils literal notranslate"><span class="pre">vcf_count()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.vcf_snps"><code class="docutils literal notranslate"><span class="pre">vcf_snps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#baskerville.vcf.vcf_sort"><code class="docutils literal notranslate"><span class="pre">vcf_sort()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-baskerville">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">baskerville</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">baskerville package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/baskerville.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="baskerville-package">
<h1>baskerville package<a class="headerlink" href="#baskerville-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="baskerville.helpers.html">baskerville.helpers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#module-baskerville.helpers.gcs_utils">baskerville.helpers.gcs_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.download_folder_from_gcs"><code class="docutils literal notranslate"><span class="pre">download_folder_from_gcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.download_from_gcs"><code class="docutils literal notranslate"><span class="pre">download_from_gcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.download_rename_inputs"><code class="docutils literal notranslate"><span class="pre">download_rename_inputs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.gcs_file_exist"><code class="docutils literal notranslate"><span class="pre">gcs_file_exist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.gcs_join"><code class="docutils literal notranslate"><span class="pre">gcs_join()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.get_filename_in_dir"><code class="docutils literal notranslate"><span class="pre">get_filename_in_dir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.is_gcs_path"><code class="docutils literal notranslate"><span class="pre">is_gcs_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.split_gcs_uri"><code class="docutils literal notranslate"><span class="pre">split_gcs_uri()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.sync_dir_to_gcs"><code class="docutils literal notranslate"><span class="pre">sync_dir_to_gcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.upload_file_gcs"><code class="docutils literal notranslate"><span class="pre">upload_file_gcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.gcs_utils.upload_folder_gcs"><code class="docutils literal notranslate"><span class="pre">upload_folder_gcs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#module-baskerville.helpers.h5_baskerville_utils">baskerville.helpers.h5_baskerville_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.h5_baskerville_utils.collect_h5"><code class="docutils literal notranslate"><span class="pre">collect_h5()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.h5_baskerville_utils.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#module-baskerville.helpers.h5_utils">baskerville.helpers.h5_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.h5_utils.collect_h5"><code class="docutils literal notranslate"><span class="pre">collect_h5()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.h5_utils.collect_h5_borzoi"><code class="docutils literal notranslate"><span class="pre">collect_h5_borzoi()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#module-baskerville.helpers.tensorrt_helpers">baskerville.helpers.tensorrt_helpers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.tensorrt_helpers.ModelOptimizer"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.tensorrt_helpers.ModelOptimizer.build"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.tensorrt_helpers.ModelOptimizer.build_func"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.build_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.tensorrt_helpers.ModelOptimizer.convert"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.convert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.tensorrt_helpers.ModelOptimizer.save"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.tensorrt_helpers.ModelOptimizer.set_calibration_data"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.set_calibration_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.tensorrt_helpers.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#module-baskerville.helpers.trt_optimized_model">baskerville.helpers.trt_optimized_model module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.trt_optimized_model.OptimizedModel"><code class="docutils literal notranslate"><span class="pre">OptimizedModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.trt_optimized_model.OptimizedModel.load_model"><code class="docutils literal notranslate"><span class="pre">OptimizedModel.load_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.trt_optimized_model.OptimizedModel.predict"><code class="docutils literal notranslate"><span class="pre">OptimizedModel.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#module-baskerville.helpers.utils">baskerville.helpers.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.utils.exec_par"><code class="docutils literal notranslate"><span class="pre">exec_par()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.helpers.html#baskerville.helpers.utils.load_extra_options"><code class="docutils literal notranslate"><span class="pre">load_extra_options()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.helpers.html#module-baskerville.helpers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="baskerville.scripts.html">baskerville.scripts package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_data">baskerville.scripts.hound_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data.curate_peaks"><code class="docutils literal notranslate"><span class="pre">curate_peaks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data.divide_contigs_chr"><code class="docutils literal notranslate"><span class="pre">divide_contigs_chr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data.divide_contigs_folds"><code class="docutils literal notranslate"><span class="pre">divide_contigs_folds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data.divide_contigs_pct"><code class="docutils literal notranslate"><span class="pre">divide_contigs_pct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data.limit_contigs"><code class="docutils literal notranslate"><span class="pre">limit_contigs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_data_align">baskerville.scripts.hound_data_align module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.GraphSeq"><code class="docutils literal notranslate"><span class="pre">GraphSeq</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.GraphSeq.chr"><code class="docutils literal notranslate"><span class="pre">GraphSeq.chr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.GraphSeq.end"><code class="docutils literal notranslate"><span class="pre">GraphSeq.end</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.GraphSeq.genome"><code class="docutils literal notranslate"><span class="pre">GraphSeq.genome</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.GraphSeq.net"><code class="docutils literal notranslate"><span class="pre">GraphSeq.net</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.GraphSeq.start"><code class="docutils literal notranslate"><span class="pre">GraphSeq.start</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.break_large_contigs"><code class="docutils literal notranslate"><span class="pre">break_large_contigs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.connect_contigs"><code class="docutils literal notranslate"><span class="pre">connect_contigs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.contig_stats_genome"><code class="docutils literal notranslate"><span class="pre">contig_stats_genome()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.divide_components_folds"><code class="docutils literal notranslate"><span class="pre">divide_components_folds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.divide_components_pct"><code class="docutils literal notranslate"><span class="pre">divide_components_pct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.intersect_contigs_nets"><code class="docutils literal notranslate"><span class="pre">intersect_contigs_nets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.make_net_graph"><code class="docutils literal notranslate"><span class="pre">make_net_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.quantify_leakage"><code class="docutils literal notranslate"><span class="pre">quantify_leakage()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.report_divide_stats"><code class="docutils literal notranslate"><span class="pre">report_divide_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_align.report_divide_stats_v1"><code class="docutils literal notranslate"><span class="pre">report_divide_stats_v1()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_data_read">baskerville.scripts.hound_data_read module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_read.CovFace"><code class="docutils literal notranslate"><span class="pre">CovFace</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_read.CovFace.close"><code class="docutils literal notranslate"><span class="pre">CovFace.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_read.CovFace.preprocess_bed"><code class="docutils literal notranslate"><span class="pre">CovFace.preprocess_bed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_read.CovFace.read"><code class="docutils literal notranslate"><span class="pre">CovFace.read()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_read.interp_nan"><code class="docutils literal notranslate"><span class="pre">interp_nan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_read.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_read.read_blacklist"><code class="docutils literal notranslate"><span class="pre">read_blacklist()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_data_write">baskerville.scripts.hound_data_write module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_write.feature_bytes"><code class="docutils literal notranslate"><span class="pre">feature_bytes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_write.feature_floats"><code class="docutils literal notranslate"><span class="pre">feature_floats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_write.fetch_dna"><code class="docutils literal notranslate"><span class="pre">fetch_dna()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_write.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_write.rround"><code class="docutils literal notranslate"><span class="pre">rround()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_data_write.tround"><code class="docutils literal notranslate"><span class="pre">tround()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_eval">baskerville.scripts.hound_eval module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_eval.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#baskerville-scripts-hound-eval-genes-module">baskerville.scripts.hound_eval_genes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_eval_spec">baskerville.scripts.hound_eval_spec module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_eval_spec.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_isd_bed">baskerville.scripts.hound_isd_bed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_isd_bed.clip_float"><code class="docutils literal notranslate"><span class="pre">clip_float()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_isd_bed.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_isd_bed.make_del_bedt"><code class="docutils literal notranslate"><span class="pre">make_del_bedt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_isd_bed.map_delseq_genes"><code class="docutils literal notranslate"><span class="pre">map_delseq_genes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_ism_bed">baskerville.scripts.hound_ism_bed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_ism_bed.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_ism_snp">baskerville.scripts.hound_ism_snp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_ism_snp.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_predbed">baskerville.scripts.hound_predbed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_predbed.bigwig_open"><code class="docutils literal notranslate"><span class="pre">bigwig_open()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_predbed.bigwig_write"><code class="docutils literal notranslate"><span class="pre">bigwig_write()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_predbed.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_snp">baskerville.scripts.hound_snp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_snp.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#baskerville-scripts-hound-snp-slurm-module">baskerville.scripts.hound_snp_slurm module</a></li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_snpgene">baskerville.scripts.hound_snpgene module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_snpgene.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_train">baskerville.scripts.hound_train module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_train.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts.hound_transfer">baskerville.scripts.hound_transfer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="baskerville.scripts.html#baskerville.scripts.hound_transfer.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="baskerville.scripts.html#module-baskerville.scripts">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-baskerville.adapters">
<span id="baskerville-adapters-module"></span><h2>baskerville.adapters module<a class="headerlink" href="#module-baskerville.adapters" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.adapters.AdapterHoulsby">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.adapters.</span></span><span class="sig-name descname"><span class="pre">AdapterHoulsby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#AdapterHoulsby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.AdapterHoulsby" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.AdapterHoulsby.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#AdapterHoulsby.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.AdapterHoulsby.build" title="Link to this definition"></a></dt>
<dd><p>Creates the variables of the layer (for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call. It is invoked automatically before
the first execution of <cite>call()</cite>.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses
(at the discretion of the subclass implementer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong>  Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.AdapterHoulsby.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#AdapterHoulsby.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.AdapterHoulsby.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.AdapterHoulsby.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#AdapterHoulsby.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.AdapterHoulsby.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.adapters.IA3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.adapters.</span></span><span class="sig-name descname"><span class="pre">IA3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#IA3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.IA3" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.IA3.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#IA3.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.IA3.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.IA3.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#IA3.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.IA3.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.adapters.IA3_ff">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.adapters.</span></span><span class="sig-name descname"><span class="pre">IA3_ff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#IA3_ff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.IA3_ff" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.IA3_ff.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#IA3_ff.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.IA3_ff.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.IA3_ff.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#IA3_ff.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.IA3_ff.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.adapters.Locon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.adapters.</span></span><span class="sig-name descname"><span class="pre">Locon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#Locon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.Locon" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.Locon.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#Locon.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.Locon.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.Locon.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#Locon.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.Locon.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.adapters.Lora">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.adapters.</span></span><span class="sig-name descname"><span class="pre">Lora</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#Lora"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.Lora" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.Lora.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#Lora.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.Lora.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.adapters.Lora.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/adapters.html#Lora.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.adapters.Lora.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-baskerville.bed">
<span id="baskerville-bed-module"></span><h2>baskerville.bed module<a class="headerlink" href="#module-baskerville.bed" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="baskerville.bed.make_bed_seqs">
<span class="sig-prename descclassname"><span class="pre">baskerville.bed.</span></span><span class="sig-name descname"><span class="pre">make_bed_seqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bed_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fasta_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stranded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/bed.html#make_bed_seqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.bed.make_bed_seqs" title="Link to this definition"></a></dt>
<dd><p>Return BED regions as sequences and regions as a list of coordinate
tuples, extended to a specified length.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.bed.make_ntwise_bed_seqs">
<span class="sig-prename descclassname"><span class="pre">baskerville.bed.</span></span><span class="sig-name descname"><span class="pre">make_ntwise_bed_seqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bed_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fasta_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stranded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/bed.html#make_ntwise_bed_seqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.bed.make_ntwise_bed_seqs" title="Link to this definition"></a></dt>
<dd><p>Return BED regions as a list of sequences centered at every nucleotide of the
bed entry, and regions as a list of coordinate tuples, extended to a specified length.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.bed.read_bed_coords">
<span class="sig-prename descclassname"><span class="pre">baskerville.bed.</span></span><span class="sig-name descname"><span class="pre">read_bed_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bed_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/bed.html#read_bed_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.bed.read_bed_coords" title="Link to this definition"></a></dt>
<dd><p>Return BED regions as a list of coordinate
tuples, extended to a specified length.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.bed.write_bedgraph">
<span class="sig-prename descclassname"><span class="pre">baskerville.bed.</span></span><span class="sig-name descname"><span class="pre">write_bedgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bedgraph_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/bed.html#write_bedgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.bed.write_bedgraph" title="Link to this definition"></a></dt>
<dd><p>Write BEDgraph files for predictions and targets from a dataset..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>np.array</em>)  Predictions.</p></li>
<li><p><strong>targets</strong> (<em>np.array</em>)  Targets.</p></li>
<li><p><strong>data_dir</strong> (<em>str</em>)  Data directory, for identifying sequences and statistics.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>)  Output directory.</p></li>
<li><p><strong>split_label</strong> (<em>str</em>)  Split label.</p></li>
<li><p><strong>bedgraph_indexes</strong> (<em>list</em>)  List of target indexes to write.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-baskerville.blocks">
<span id="baskerville-blocks-module"></span><h2>baskerville.blocks module<a class="headerlink" href="#module-baskerville.blocks" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.center_average">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">center_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#center_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.center_average" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.center_slice">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">center_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#center_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.center_slice" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.concat_dist_2d">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">concat_dist_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#concat_dist_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.concat_dist_2d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.concat_position">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">concat_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'abs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#concat_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.concat_position" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_block">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_block" title="Link to this definition"></a></dt>
<dd><p>Construct a single convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters</strong>  Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>stride</strong>  Conv1D stride</p></li>
<li><p><strong>dilation_rate</strong>  Conv1D dilation rate</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>conv_type</strong>  Conv1D layer type</p></li>
<li><p><strong>residual</strong>  Residual connection boolean</p></li>
<li><p><strong>pool_size</strong>  Max pool width</p></li>
<li><p><strong>norm_type</strong>  Apply batch or layer normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
<li><p><strong>norm_gamma</strong>  BatchNorm gamma (defaults according to residual)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_block_2d">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_block_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ones'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_block_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_block_2d" title="Link to this definition"></a></dt>
<dd><p>Construct a single 2D convolution block.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_dna">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_dna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_dna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_dna" title="Link to this definition"></a></dt>
<dd><p>Construct a single convolution block, assumed to be operating on DNA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters</strong>  Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>stride</strong>  Conv1D stride</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>conv_type</strong>  Conv1D layer type</p></li>
<li><p><strong>pool_size</strong>  Max pool width</p></li>
<li><p><strong>norm_type</strong>  Apply batch or layer normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_nac">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_nac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_nac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_nac" title="Link to this definition"></a></dt>
<dd><p>Construct a single convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters</strong>  Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>stride</strong>  Conv1D stride</p></li>
<li><p><strong>dilation_rate</strong>  Conv1D dilation rate</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>conv_type</strong>  Conv1D layer type</p></li>
<li><p><strong>residual</strong>  Residual connection boolean</p></li>
<li><p><strong>pool_size</strong>  Max pool width</p></li>
<li><p><strong>norm_type</strong>  Apply batch or layer normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_next">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_expansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_next" title="Link to this definition"></a></dt>
<dd><p>Construct a single convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters</strong>  Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>dilation_rate</strong>  Conv1D dilation rate</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>residual</strong>  Residual connection boolean</p></li>
<li><p><strong>pool_size</strong>  Max pool width</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_tower">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_tower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divisible_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reprs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_tower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_tower" title="Link to this definition"></a></dt>
<dd><p>Construct a reducing convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters_init</strong>  Initial Conv1D filters</p></li>
<li><p><strong>filters_end</strong>  End Conv1D filters</p></li>
<li><p><strong>filters_mult</strong>  Multiplier for Conv1D filters</p></li>
<li><p><strong>divisible_by</strong>  Round filters to be divisible by (eg a power of two)</p></li>
<li><p><strong>repeat</strong>  Tower repetitions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_tower_nac">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_tower_nac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divisible_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reprs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_tower_nac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_tower_nac" title="Link to this definition"></a></dt>
<dd><p>Construct a reducing convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters_init</strong>  Initial Conv1D filters</p></li>
<li><p><strong>filters_end</strong>  End Conv1D filters</p></li>
<li><p><strong>filters_mult</strong>  Multiplier for Conv1D filters</p></li>
<li><p><strong>divisible_by</strong>  Round filters to be divisible by (eg a power of two)</p></li>
<li><p><strong>repeat</strong>  Tower repetitions</p></li>
<li><p><strong>reprs</strong>  Append representations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.conv_tower_v1">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">conv_tower_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#conv_tower_v1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.conv_tower_v1" title="Link to this definition"></a></dt>
<dd><p>Construct a reducing convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters_init</strong>  Initial Conv1D filters</p></li>
<li><p><strong>filters_mult</strong>  Multiplier for Conv1D filters</p></li>
<li><p><strong>repeat</strong>  Conv block repetitions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.convnext_tower">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">convnext_tower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divisible_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reprs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#convnext_tower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.convnext_tower" title="Link to this definition"></a></dt>
<dd><p>Abc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters_init</strong>  Initial Conv1D filters</p></li>
<li><p><strong>filters_end</strong>  End Conv1D filters</p></li>
<li><p><strong>filters_mult</strong>  Multiplier for Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>dropout</strong>  Dropout on subsequent convolution blocks.</p></li>
<li><p><strong>pool_size</strong>  Pool width.</p></li>
<li><p><strong>repeat</strong>  Residual block repetitions</p></li>
<li><p><strong>num_convs</strong>  Conv blocks per residual layer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.cropping_2d">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">cropping_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cropping</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#cropping_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.cropping_2d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.dense_block">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">dense_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#dense_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.dense_block" title="Link to this definition"></a></dt>
<dd><p>Construct a single convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>units</strong>  Conv1D filters</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>activation_end</strong>  Compute activation after the other operations</p></li>
<li><p><strong>flatten</strong>  Flatten across positional axis</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>l1_scale</strong>  L1 regularization weight.</p></li>
<li><p><strong>residual</strong>  Residual connection boolean</p></li>
<li><p><strong>batch_norm</strong>  Apply batch normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
<li><p><strong>norm_gamma</strong>  BatchNorm gamma (defaults according to residual)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length(?), features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.dense_nac">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">dense_nac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#dense_nac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.dense_nac" title="Link to this definition"></a></dt>
<dd><p>Construct a single convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>units</strong>  Conv1D filters</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>activation_end</strong>  Compute activation after the other operations</p></li>
<li><p><strong>flatten</strong>  Flatten across positional axis</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>l1_scale</strong>  L1 regularization weight.</p></li>
<li><p><strong>residual</strong>  Residual connection boolean</p></li>
<li><p><strong>batch_norm</strong>  Apply batch normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
<li><p><strong>norm_gamma</strong>  BatchNorm gamma (defaults according to residual)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length(?), features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.dilated_dense">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">dilated_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#dilated_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.dilated_dense" title="Link to this definition"></a></dt>
<dd><p>Construct a residual dilated dense block.</p>
<p>Args:</p>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.dilated_residual">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">dilated_residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#dilated_residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.dilated_residual" title="Link to this definition"></a></dt>
<dd><p>Construct a residual dilated convolution block.</p>
<p>Args:</p>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.dilated_residual_2d">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">dilated_residual_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#dilated_residual_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.dilated_residual_2d" title="Link to this definition"></a></dt>
<dd><p>Construct a residual dilated convolution block.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.dilated_residual_nac">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">dilated_residual_nac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#dilated_residual_nac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.dilated_residual_nac" title="Link to this definition"></a></dt>
<dd><p>Construct a residual dilated convolution block.</p>
<p>Args:</p>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.factor_inverse">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">factor_inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_file</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#factor_inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.factor_inverse" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.final">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">final</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#final"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.final" title="Link to this definition"></a></dt>
<dd><p>Final simple transformation before comparison to targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>units</strong>  Dense units</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>flatten</strong>  Flatten positional axis.</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>l1_scale</strong>  L1 regularization weight.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length(?), units] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.global_context">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">global_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#global_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.global_context" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.one_to_two">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">one_to_two</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#one_to_two"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.one_to_two" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.res_tower">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">res_tower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divisible_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reprs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#res_tower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.res_tower" title="Link to this definition"></a></dt>
<dd><p>Construct a reducing convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters_init</strong>  Initial Conv1D filters</p></li>
<li><p><strong>filters_end</strong>  End Conv1D filters</p></li>
<li><p><strong>filters_mult</strong>  Multiplier for Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>dropout</strong>  Dropout on subsequent convolution blocks.</p></li>
<li><p><strong>pool_size</strong>  Pool width.</p></li>
<li><p><strong>repeat</strong>  Residual block repetitions</p></li>
<li><p><strong>num_convs</strong>  Conv blocks per residual layer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.squeeze_excite">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">squeeze_excite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottleneck_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'glorot_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_fun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#squeeze_excite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.squeeze_excite" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.swin_transformer">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">swin_transformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#swin_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.swin_transformer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.symmetrize_2d">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">symmetrize_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#symmetrize_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.symmetrize_2d" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.tconv_nac">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">tconv_nac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#tconv_nac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.tconv_nac" title="Link to this definition"></a></dt>
<dd><p>Construct a single transposed convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters</strong>  Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>stride</strong>  UpSample stride</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>conv_type</strong>  Conv1D layer type</p></li>
<li><p><strong>norm_type</strong>  Apply batch or layer normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, stride*seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.transformer">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">transformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_expansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_position_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mha_l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_position_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mha_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seqlen_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.transformer" title="Link to this definition"></a></dt>
<dd><p>Construct a transformer block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>key_size</strong>  Conv block repetitions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.transformer2">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">transformer2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_position_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_expansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#transformer2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.transformer2" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Construct a transformer block, with length-wise pooling before</dt><dd><p>returning to full length.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>key_size</strong>  Conv block repetitions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.transformer_dense">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">transformer_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_expansion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#transformer_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.transformer_dense" title="Link to this definition"></a></dt>
<dd><p>Transformer block dense portion.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.transformer_split">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">transformer_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_expansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_position_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mha_l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_position_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mha_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#transformer_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.transformer_split" title="Link to this definition"></a></dt>
<dd><p>Construct a transformer block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>key_size</strong>  Conv block repetitions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.transformer_tower">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">transformer_tower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transformer'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#transformer_tower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.transformer_tower" title="Link to this definition"></a></dt>
<dd><p>Construct a tower of repeated transformer blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>repeat</strong>  Conv block repetitions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.unet_concat">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">unet_concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unet_repr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#unet_concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.unet_concat" title="Link to this definition"></a></dt>
<dd><p>Construct a single transposed convolution block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>filters</strong>  Conv1D filters</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>stride</strong>  UpSample stride</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>conv_type</strong>  Conv1D layer type</p></li>
<li><p><strong>norm_type</strong>  Apply batch or layer normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, stride*seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.unet_conv">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">unet_conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unet_repr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'he_normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#unet_conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.unet_conv" title="Link to this definition"></a></dt>
<dd><p>Construct a feature pyramid network block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  [batch_size, seq_length, features] input sequence</p></li>
<li><p><strong>kernel_size</strong>  Conv1D kernel_size</p></li>
<li><p><strong>activation</strong>  relu/gelu/etc</p></li>
<li><p><strong>stride</strong>  UpSample stride</p></li>
<li><p><strong>l2_scale</strong>  L2 regularization weight.</p></li>
<li><p><strong>dropout</strong>  Dropout rate probability</p></li>
<li><p><strong>norm_type</strong>  Apply batch or layer normalization</p></li>
<li><p><strong>bn_momentum</strong>  BatchNorm momentum</p></li>
<li><p><strong>upsample_conv</strong>  Conv1D the upsampled input path</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[batch_size, seq_length, features] output sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.upper_tri">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">upper_tri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonal_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#upper_tri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.upper_tri" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.blocks.wheeze_excite">
<span class="sig-prename descclassname"><span class="pre">baskerville.blocks.</span></span><span class="sig-name descname"><span class="pre">wheeze_excite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/blocks.html#wheeze_excite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.blocks.wheeze_excite" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-baskerville.data">
<span id="baskerville-data-module"></span><h2>baskerville.data module<a class="headerlink" href="#module-baskerville.data" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.data.Contig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">Contig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genome</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#baskerville.data.Contig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.Contig.chr">
<span class="sig-name descname"><span class="pre">chr</span></span><a class="headerlink" href="#baskerville.data.Contig.chr" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.Contig.end">
<span class="sig-name descname"><span class="pre">end</span></span><a class="headerlink" href="#baskerville.data.Contig.end" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.Contig.genome">
<span class="sig-name descname"><span class="pre">genome</span></span><a class="headerlink" href="#baskerville.data.Contig.genome" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.Contig.start">
<span class="sig-name descname"><span class="pre">start</span></span><a class="headerlink" href="#baskerville.data.Contig.start" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.data.ModelSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">ModelSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genome</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#baskerville.data.ModelSeq" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.ModelSeq.chr">
<span class="sig-name descname"><span class="pre">chr</span></span><a class="headerlink" href="#baskerville.data.ModelSeq.chr" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.ModelSeq.end">
<span class="sig-name descname"><span class="pre">end</span></span><a class="headerlink" href="#baskerville.data.ModelSeq.end" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.ModelSeq.genome">
<span class="sig-name descname"><span class="pre">genome</span></span><a class="headerlink" href="#baskerville.data.ModelSeq.genome" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.ModelSeq.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#baskerville.data.ModelSeq.label" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.data.ModelSeq.start">
<span class="sig-name descname"><span class="pre">start</span></span><a class="headerlink" href="#baskerville.data.ModelSeq.start" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.data.annotate_unmap">
<span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">annotate_unmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mseqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmap_bed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/data.html#annotate_unmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.data.annotate_unmap" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Intersect the sequence segments with unmappable regions</dt><dd><p>and annoate the segments as NaN to possible be ignored.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mseqs</strong>  list of ModelSeqs</p></li>
<li><p><strong>unmap_bed</strong>  unmappable regions BED file</p></li>
<li><p><strong>seq_length</strong>  sequence length (after cropping)</p></li>
<li><p><strong>pool_width</strong>  pooled bin width</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>NxL binary NA indicators</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seqs_unmap</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.data.break_large_contigs">
<span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">break_large_contigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contigs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">break_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/data.html#break_large_contigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.data.break_large_contigs" title="Link to this definition"></a></dt>
<dd><p>Break large contigs in half until all contigs are under
the size threshold.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.data.contig_sequences">
<span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">contig_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contigs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/data.html#contig_sequences"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.data.contig_sequences" title="Link to this definition"></a></dt>
<dd><p>Break up a list of Contigs into a list of model length
and stride sequence contigs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.data.load_chromosomes">
<span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">load_chromosomes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genome_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/data.html#load_chromosomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.data.load_chromosomes" title="Link to this definition"></a></dt>
<dd><p>Load genome segments from either a FASTA file or
chromosome length table.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.data.rejoin_large_contigs">
<span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">rejoin_large_contigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contigs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/data.html#rejoin_large_contigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.data.rejoin_large_contigs" title="Link to this definition"></a></dt>
<dd><p>Rejoin large contigs that were broken up before alignment comparison.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.data.split_contigs">
<span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">split_contigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chrom_segments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaps_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/data.html#split_contigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.data.split_contigs" title="Link to this definition"></a></dt>
<dd><p>Split the assembly up into contigs defined by the gaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chrom_segments</strong>  dict mapping chromosome names to lists of (start,end)</p></li>
<li><p><strong>gaps_file</strong>  file specifying assembly gaps</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>same, with segments broken by the assembly gaps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>chrom_segments</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.data.write_seqs_bed">
<span class="sig-prename descclassname"><span class="pre">baskerville.data.</span></span><span class="sig-name descname"><span class="pre">write_seqs_bed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bed_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/data.html#write_seqs_bed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.data.write_seqs_bed" title="Link to this definition"></a></dt>
<dd><p>Write sequences to BED file.</p>
</dd></dl>

</section>
<section id="module-baskerville.dataset">
<span id="baskerville-dataset-module"></span><h2>baskerville.dataset module<a class="headerlink" href="#module-baskerville.dataset" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.dataset.SeqDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.dataset.</span></span><span class="sig-name descname"><span class="pre">SeqDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_length_crop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'eval'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tfr_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_slice_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#SeqDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.SeqDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Labeled sequence dataset for Tensorflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<em>str</em>)  Dataset directory.</p></li>
<li><p><strong>split_label</strong> (<em>str</em>)  Dataset split, e.g. train, valid, test.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>)  Batch size.</p></li>
<li><p><strong>shuffle_buffer</strong> (<em>int</em>)  Shuffle buffer size. Defaults to 128.</p></li>
<li><p><strong>seq_length_crop</strong> (<em>int</em>)  Sequence length to crop from sides. Defaults to 0.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  Dataset mode, e.g. train/eval. Defaults to eval.</p></li>
<li><p><strong>tfr_pattern</strong> (<em>str</em>)  TFRecord pattern to glob. Defaults to split_label.</p></li>
<li><p><strong>targets_slice_file</strong> (<em>str</em>)  Targets table from which to slice a target subset.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.dataset.SeqDataset.batches_per_epoch">
<span class="sig-name descname"><span class="pre">batches_per_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#SeqDataset.batches_per_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.SeqDataset.batches_per_epoch" title="Link to this definition"></a></dt>
<dd><p>Compute number of batches per epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.dataset.SeqDataset.compute_stats">
<span class="sig-name descname"><span class="pre">compute_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#SeqDataset.compute_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.SeqDataset.compute_stats" title="Link to this definition"></a></dt>
<dd><p>Iterate over the TFRecords to count sequences, and infer
seq_depth and num_targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.dataset.SeqDataset.distribute">
<span class="sig-name descname"><span class="pre">distribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#SeqDataset.distribute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.SeqDataset.distribute" title="Link to this definition"></a></dt>
<dd><p>Wrap Dataset to distribute across devices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.dataset.SeqDataset.generate_parser">
<span class="sig-name descname"><span class="pre">generate_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#SeqDataset.generate_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.SeqDataset.generate_parser" title="Link to this definition"></a></dt>
<dd><p>Generate parser function for TFRecordDataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.dataset.SeqDataset.make_dataset">
<span class="sig-name descname"><span class="pre">make_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cycle_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#SeqDataset.make_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.SeqDataset.make_dataset" title="Link to this definition"></a></dt>
<dd><p>Make tf.data.Dataset w/ transformations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.dataset.SeqDataset.numpy">
<span class="sig-name descname"><span class="pre">numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float16'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#SeqDataset.numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.SeqDataset.numpy" title="Link to this definition"></a></dt>
<dd><p>Convert TFR inputs and/or outputs to numpy arrays.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dataset.file_to_records">
<span class="sig-prename descclassname"><span class="pre">baskerville.dataset.</span></span><span class="sig-name descname"><span class="pre">file_to_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#file_to_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.file_to_records" title="Link to this definition"></a></dt>
<dd><p>Read TFRecord file into tf.data.Dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dataset.make_strand_transform">
<span class="sig-prename descclassname"><span class="pre">baskerville.dataset.</span></span><span class="sig-name descname"><span class="pre">make_strand_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_strand_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#make_strand_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.make_strand_transform" title="Link to this definition"></a></dt>
<dd><p>Make a sparse matrix to sum strand pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>targets_df</strong> (<em>pd.DataFrame</em>)  Targets DataFrame.</p></li>
<li><p><strong>targets_strand_df</strong> (<em>pd.DataFrame</em>)  Targets DataFrame, with strand pairs collapsed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sparse matrix to sum strand pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scipy.sparse.dok_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dataset.targets_prep_strand">
<span class="sig-prename descclassname"><span class="pre">baskerville.dataset.</span></span><span class="sig-name descname"><span class="pre">targets_prep_strand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#targets_prep_strand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.targets_prep_strand" title="Link to this definition"></a></dt>
<dd><p>Adjust targets table for merged stranded datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>targets_df</strong>  pandas DataFrame of targets</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pandas DataFrame of targets, with stranded</dt><dd><p>targets collapsed into a single row</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>targets_df</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dataset.untransform_preds">
<span class="sig-prename descclassname"><span class="pre">baskerville.dataset.</span></span><span class="sig-name descname"><span class="pre">untransform_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unclip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#untransform_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.untransform_preds" title="Link to this definition"></a></dt>
<dd><p>Undo the squashing transformations performed for the tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>np.array</em>)  Predictions LxT.</p></li>
<li><p><strong>targets_df</strong> (<em>pd.DataFrame</em>)  Targets information table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Untransformed predictions LxT.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>preds (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dataset.untransform_preds1">
<span class="sig-prename descclassname"><span class="pre">baskerville.dataset.</span></span><span class="sig-name descname"><span class="pre">untransform_preds1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unclip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dataset.html#untransform_preds1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dataset.untransform_preds1" title="Link to this definition"></a></dt>
<dd><p>Undo the squashing transformations performed for the tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>np.array</em>)  Predictions LxT.</p></li>
<li><p><strong>targets_df</strong> (<em>pd.DataFrame</em>)  Targets information table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Untransformed predictions LxT.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>preds (np.array)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-baskerville.dna">
<span id="baskerville-dna-module"></span><h2>baskerville.dna module<a class="headerlink" href="#module-baskerville.dna" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.dna_1hot">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">dna_1hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_uniform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#dna_1hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.dna_1hot" title="Link to this definition"></a></dt>
<dd><p>Convert a DNA sequence to a 1-hot encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>str</em>)  DNA sequence.</p></li>
<li><p><strong>seq_len</strong> (<em>int</em>)  length to extend/trim sequences to.</p></li>
<li><p><strong>n_uniform</strong> (<em>bool</em>)  represent Ns as 0.25, forcing float16,</p></li>
<li><p><strong>n_sample</strong> (<em>bool</em>)  sample ACGT for N</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1-hot encoding of DNA sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seq_code (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.dna_1hot_index">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">dna_1hot_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#dna_1hot_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.dna_1hot_index" title="Link to this definition"></a></dt>
<dd><p>Convert a DNA sequence to an index encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>str</em>)  DNA sequence.</p></li>
<li><p><strong>n_sample</strong> (<em>bool</em>)  sample ACGT for N</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index encoding of DNA sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seq_code (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.dna_rc">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">dna_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#dna_rc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.dna_rc" title="Link to this definition"></a></dt>
<dd><p>Reverse complement a DNA sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seq</strong> (<em>str</em>)  DNA sequence.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reverse complement of the input sequence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.hot1_augment">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">hot1_augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwdrc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#hot1_augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.hot1_augment" title="Link to this definition"></a></dt>
<dd><p>Transform a batch of one hot coded sequences to augment training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xb</strong> (<em>np.array</em>)  Batch x Length x 4 one hot coded sequences.</p></li>
<li><p><strong>fwdrc</strong> (<em>bool</em>)  Representing forward versus reverse complement strand.</p></li>
<li><p><strong>shift</strong> (<em>int</em>)  Shift sequences by this many positions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed batch of sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Xbt (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.hot1_delete">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">hot1_delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#hot1_delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.hot1_delete" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Delete nucleotides starting at a given position</dt><dd><p>in the Lx4 1-hot encoded sequence.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_1hot</strong> (<em>np.array</em>)  1-hot encoded sequence.</p></li>
<li><p><strong>pos</strong> (<em>int</em>)  Position to start deleting.</p></li>
<li><p><strong>delete_len</strong> (<em>int</em>)  Number of nucleotides to delete.</p></li>
<li><p><strong>pad_value</strong> (<em>float</em>)  Value to pad the end with.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>In-place transformed sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seq_1hot (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.hot1_dna">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">hot1_dna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs_1hot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#hot1_dna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.hot1_dna" title="Link to this definition"></a></dt>
<dd><p>Convert 1-hot coded sequences to ACGTN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seq_1hot</strong> (<em>np.array</em>)  1-hot encoded sequences.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of DNA sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seqs [str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.hot1_get">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">hot1_get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#hot1_get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.hot1_get" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Return the nucleotide corresponding to the one hot coding</dt><dd><p>of position pos in the Lx4 array seqs_1hot.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seqs_1hot</strong> (<em>np.array</em>)  1-hot encoded sequences.</p></li>
<li><p><strong>pos</strong> (<em>int</em>)  Position to get nucleotide.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nucleotide.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nt (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.hot1_insert">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">hot1_insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insert_seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#hot1_insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.hot1_insert" title="Link to this definition"></a></dt>
<dd><p>Insert sequence at a given position in the 1-hot encoded sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_1hot</strong> (<em>np.array</em>)  1-hot encoded sequence.</p></li>
<li><p><strong>pos</strong> (<em>int</em>)  Position to insert sequence.</p></li>
<li><p><strong>insert_seq</strong> (<em>str</em>)  Sequence to insert.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>In-place transformed sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seq_1hot (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.hot1_rc">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">hot1_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs_1hot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#hot1_rc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.hot1_rc" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Reverse complement a batch of one hot coded sequences,</dt><dd><p>while being robust to additional tracks beyond the four
nucleotides.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seqs_1hot</strong> (<em>np.array</em>)  1-hot encoded sequences.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reverse complemented sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seqs_1hot_rc (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.dna.hot1_set">
<span class="sig-prename descclassname"><span class="pre">baskerville.dna.</span></span><span class="sig-name descname"><span class="pre">hot1_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/dna.html#hot1_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.dna.hot1_set" title="Link to this definition"></a></dt>
<dd><p>Set position in a 1-hot encoded sequence to given nucleotide.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_1hot</strong> (<em>np.array</em>)  1-hot encoded sequence.</p></li>
<li><p><strong>pos</strong> (<em>int</em>)  Position to set nucleotide.</p></li>
<li><p><strong>nt</strong> (<em>str</em>)  Nucleotide to set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>In-place transformed sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>seq_1hot (np.array)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-baskerville.gene">
<span id="baskerville-gene-module"></span><h2>baskerville.gene module<a class="headerlink" href="#module-baskerville.gene" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.gene.Gene">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.gene.</span></span><span class="sig-name descname"><span class="pre">Gene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chrom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Gene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Gene" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for managing genes in an isoform-agnostic way, taking
the union of exons across isoforms.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Gene.add_exon">
<span class="sig-name descname"><span class="pre">add_exon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Gene.add_exon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Gene.add_exon" title="Link to this definition"></a></dt>
<dd><p>BED 0-indexing assumed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Gene.get_exons">
<span class="sig-name descname"><span class="pre">get_exons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Gene.get_exons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Gene.get_exons" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Gene.midpoint">
<span class="sig-name descname"><span class="pre">midpoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Gene.midpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Gene.midpoint" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Gene.output_slice">
<span class="sig-name descname"><span class="pre">output_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">majority_overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Gene.output_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Gene.output_slice" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Gene.output_slice_old">
<span class="sig-name descname"><span class="pre">output_slice_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Gene.output_slice_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Gene.output_slice_old" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Gene.span">
<span class="sig-name descname"><span class="pre">span</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Gene.span"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Gene.span" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.gene.GenomicInterval">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.gene.</span></span><span class="sig-name descname"><span class="pre">GenomicInterval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#GenomicInterval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.GenomicInterval" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.gene.Transcriptome">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.gene.</span></span><span class="sig-name descname"><span class="pre">Transcriptome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gtf_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Transcriptome"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Transcriptome" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Transcriptome.bedtool_exon">
<span class="sig-name descname"><span class="pre">bedtool_exon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Transcriptome.bedtool_exon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Transcriptome.bedtool_exon" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Transcriptome.bedtool_span">
<span class="sig-name descname"><span class="pre">bedtool_span</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Transcriptome.bedtool_span"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Transcriptome.bedtool_span" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Transcriptome.read_gtf">
<span class="sig-name descname"><span class="pre">read_gtf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gtf_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Transcriptome.read_gtf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Transcriptome.read_gtf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Transcriptome.write_bed_exon">
<span class="sig-name descname"><span class="pre">write_bed_exon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bed_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Transcriptome.write_bed_exon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Transcriptome.write_bed_exon" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.gene.Transcriptome.write_bed_span">
<span class="sig-name descname"><span class="pre">write_bed_span</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bed_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#Transcriptome.write_bed_span"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.Transcriptome.write_bed_span" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.gene.gtf_kv">
<span class="sig-prename descclassname"><span class="pre">baskerville.gene.</span></span><span class="sig-name descname"><span class="pre">gtf_kv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/gene.html#gtf_kv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.gene.gtf_kv" title="Link to this definition"></a></dt>
<dd><p>Convert the last gtf section of key/value pairs into a dict.</p>
</dd></dl>

</section>
<section id="module-baskerville.layers">
<span id="baskerville-layers-module"></span><h2>baskerville.layers module<a class="headerlink" href="#module-baskerville.layers" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.CenterAverage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">CenterAverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#CenterAverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.CenterAverage" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Average the center of the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>center</strong> (<em>int</em>)  Length of the center slice.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.CenterAverage.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#CenterAverage.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.CenterAverage.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.CenterAverage.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#CenterAverage.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.CenterAverage.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.CenterSlice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">CenterSlice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#CenterSlice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.CenterSlice" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Scale the input by a learned value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>[</em><em>int</em><em>]</em>)  Axis/axes along which to scale.</p></li>
<li><p><strong>initializer</strong>  Initializer for the scale weight.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.CenterSlice.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#CenterSlice.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.CenterSlice.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.CenterSlice.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#CenterSlice.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.CenterSlice.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.ConcatDist2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">ConcatDist2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#ConcatDist2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.ConcatDist2D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Concatenate the pairwise distance to 2d feature matrix.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.ConcatDist2D.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#ConcatDist2D.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.ConcatDist2D.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.ConcatPosition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">ConcatPosition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#ConcatPosition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.ConcatPosition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Concatenate position to 1d feature vectors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.ConcatPosition.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#ConcatPosition.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.ConcatPosition.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.ConcatPosition.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#ConcatPosition.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.ConcatPosition.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.EnsembleReverseComplement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">EnsembleReverseComplement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#EnsembleReverseComplement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.EnsembleReverseComplement" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Expand tensor to include reverse complement of one hot encoded DNA sequence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.EnsembleReverseComplement.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs_1hot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#EnsembleReverseComplement.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.EnsembleReverseComplement.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.EnsembleShift">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">EnsembleShift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#EnsembleShift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.EnsembleShift" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Expand tensor to include shifts of one hot encoded DNA sequence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.EnsembleShift.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs_1hot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#EnsembleShift.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.EnsembleShift.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.EnsembleShift.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#EnsembleShift.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.EnsembleShift.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.FactorInverse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">FactorInverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#FactorInverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.FactorInverse" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Inverse a target matrix factorization.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.FactorInverse.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#FactorInverse.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.FactorInverse.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.FactorInverse.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#FactorInverse.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.FactorInverse.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.GlobalContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">GlobalContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#GlobalContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.GlobalContext" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.GlobalContext.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#GlobalContext.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.GlobalContext.build" title="Link to this definition"></a></dt>
<dd><p>Creates the variables of the layer (for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call. It is invoked automatically before
the first execution of <cite>call()</cite>.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses
(at the discretion of the subclass implementer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong>  Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.GlobalContext.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#GlobalContext.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.GlobalContext.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.LengthAverage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">LengthAverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#LengthAverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.LengthAverage" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Average across a variable length sequence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.LengthAverage.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#LengthAverage.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.LengthAverage.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.MultiheadAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">MultiheadAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#MultiheadAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.MultiheadAttention" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Multi-head attention.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.MultiheadAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#MultiheadAttention.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.MultiheadAttention.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.MultiheadAttention.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#MultiheadAttention.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.MultiheadAttention.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.OneToTwo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">OneToTwo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#OneToTwo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.OneToTwo" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Transform 1d to 2d with i,j vectors operated on.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.OneToTwo.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oned</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#OneToTwo.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.OneToTwo.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.OneToTwo.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#OneToTwo.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.OneToTwo.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.Scale">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">Scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Scale" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Scale the input by a learned value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>[</em><em>int</em><em>]</em>)  Axis/axes along which to scale.</p></li>
<li><p><strong>initializer</strong>  Initializer for the scale weight.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.Scale.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Scale.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Scale.build" title="Link to this definition"></a></dt>
<dd><p>Creates the variables of the layer (for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call. It is invoked automatically before
the first execution of <cite>call()</cite>.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses
(at the discretion of the subclass implementer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong>  Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.Scale.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Scale.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Scale.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.Scale.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Scale.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Scale.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.SoftmaxPool1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">SoftmaxPool1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SoftmaxPool1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SoftmaxPool1D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Pooling operation with optional weights.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SoftmaxPool1D.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SoftmaxPool1D.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SoftmaxPool1D.build" title="Link to this definition"></a></dt>
<dd><p>Creates the variables of the layer (for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call. It is invoked automatically before
the first execution of <cite>call()</cite>.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses
(at the discretion of the subclass implementer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong>  Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SoftmaxPool1D.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SoftmaxPool1D.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SoftmaxPool1D.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SoftmaxPool1D.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SoftmaxPool1D.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SoftmaxPool1D.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.Softplus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">Softplus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Softplus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Softplus" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Safe softplus, clipping large values.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.Softplus.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Softplus.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Softplus.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.Softplus.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Softplus.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Softplus.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.SqueezeExcite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">SqueezeExcite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SqueezeExcite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SqueezeExcite" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SqueezeExcite.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SqueezeExcite.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SqueezeExcite.build" title="Link to this definition"></a></dt>
<dd><p>Creates the variables of the layer (for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call. It is invoked automatically before
the first execution of <cite>call()</cite>.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses
(at the discretion of the subclass implementer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong>  Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SqueezeExcite.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SqueezeExcite.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SqueezeExcite.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SqueezeExcite.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SqueezeExcite.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SqueezeExcite.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.StochasticReverseComplement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">StochasticReverseComplement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#StochasticReverseComplement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.StochasticReverseComplement" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Stochastically reverse complement a one hot encoded DNA sequence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.StochasticReverseComplement.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#StochasticReverseComplement.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.StochasticReverseComplement.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.StochasticShift">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">StochasticShift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#StochasticShift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.StochasticShift" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Stochastically shift a one hot encoded DNA sequence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.StochasticShift.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#StochasticShift.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.StochasticShift.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.StochasticShift.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#StochasticShift.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.StochasticShift.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.SwitchReverse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">SwitchReverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SwitchReverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SwitchReverse" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Reverse predictions if the inputs were reverse complemented.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SwitchReverse.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_reverse</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SwitchReverse.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SwitchReverse.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SwitchReverse.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SwitchReverse.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SwitchReverse.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.SwitchReverseTriu">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">SwitchReverseTriu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SwitchReverseTriu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SwitchReverseTriu" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SwitchReverseTriu.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_reverse</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SwitchReverseTriu.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SwitchReverseTriu.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.SwitchReverseTriu.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#SwitchReverseTriu.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.SwitchReverseTriu.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.Symmetrize2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">Symmetrize2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Symmetrize2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Symmetrize2D" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Take the average of a matrix and its transpose to enforce symmetry.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.Symmetrize2D.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#Symmetrize2D.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.Symmetrize2D.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.UpperTri">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">UpperTri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#UpperTri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.UpperTri" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Unroll matrix to its upper triangular portion.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.UpperTri.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#UpperTri.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.UpperTri.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.UpperTri.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#UpperTri.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.UpperTri.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.layers.WheezeExcite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">WheezeExcite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#WheezeExcite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.WheezeExcite" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.WheezeExcite.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#WheezeExcite.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.WheezeExcite.build" title="Link to this definition"></a></dt>
<dd><p>Creates the variables of the layer (for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call. It is invoked automatically before
the first execution of <cite>call()</cite>.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses
(at the discretion of the subclass implementer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong>  Instance of <cite>TensorShape</cite>, or list of instances of
<cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.WheezeExcite.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#WheezeExcite.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.WheezeExcite.call" title="Link to this definition"></a></dt>
<dd><p>This is where the layers logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong>  <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong>  Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong>  <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layers <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.layers.WheezeExcite.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#WheezeExcite.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.WheezeExcite.get_config" title="Link to this definition"></a></dt>
<dd><p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <cite>Network</cite> (one layer of abstraction above).</p>
<p>Note that <cite>get_config()</cite> does not guarantee to return a fresh copy of
dict every time it is called. The callers should make a copy of the
returned dict if they want to modify it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Python dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.layers.activate">
<span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">activate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#activate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.activate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.layers.positional_features">
<span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">positional_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#positional_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.positional_features" title="Link to this definition"></a></dt>
<dd><p>Compute relative positional encodings/features.</p>
<p>Each positional feature function will compute/provide the same fraction of
features, making up the total of feature_size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong>  Tensor of relative positions of arbitrary shape.</p></li>
<li><p><strong>feature_size</strong>  Total number of basis functions.</p></li>
<li><p><strong>seq_length</strong>  Sequence length denoting the characteristic length that
the individual positional features can use. This is required since the
parametrization of the input features should be independent of <cite>positions</cite>
while it could still require to use the total number of features.</p></li>
<li><p><strong>symmetric</strong>  If True, the resulting features will be symmetric across the
relative position of 0 (i.e. only absolute value of positions will
matter). If false, then both the symmetric and asymmetric version
(symmetric multiplied by sign(positions)) of the features will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>positions.shape + (feature_size,)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor of shape</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.layers.positional_features_central_mask">
<span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">positional_features_central_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#positional_features_central_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.positional_features_central_mask" title="Link to this definition"></a></dt>
<dd><p>Positional features using a central mask (allow only central features).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.layers.relative_shift">
<span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">relative_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#relative_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.relative_shift" title="Link to this definition"></a></dt>
<dd><p>Shift the relative logits like in TransformerXL.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.layers.shift_sequence">
<span class="sig-prename descclassname"><span class="pre">baskerville.layers.</span></span><span class="sig-name descname"><span class="pre">shift_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/layers.html#shift_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.layers.shift_sequence" title="Link to this definition"></a></dt>
<dd><p>Shift a sequence left or right by shift_amount.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong>  [batch_size, seq_length, seq_depth] sequence</p></li>
<li><p><strong>shift</strong>  signed shift value (tf.int32 or int)</p></li>
<li><p><strong>pad_value</strong>  value to fill the padding (primitive or scalar tf.Tensor)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-baskerville.metrics">
<span id="baskerville-metrics-module"></span><h2>baskerville.metrics module<a class="headerlink" href="#module-baskerville.metrics" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.metrics.MeanSquaredErrorUDot">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">MeanSquaredErrorUDot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udot_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mse_udot'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#MeanSquaredErrorUDot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.MeanSquaredErrorUDot" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LossFunctionWrapper</span></code></p>
<p>Mean squared error with mean-normalized specificity term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>udot_weight</strong>  Weight of the mean-normalized specificity term.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.metrics.PearsonR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">PearsonR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#PearsonR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.PearsonR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></p>
<p>PearsonR metric for multi-task data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_targets</strong> (<em>int</em>)  Number of tasks.</p></li>
<li><p><strong>summarize</strong> (<em>bool</em>)  Whether to summarize over all tasks.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.PearsonR.reset_state">
<span class="sig-name descname"><span class="pre">reset_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#PearsonR.reset_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.PearsonR.reset_state" title="Link to this definition"></a></dt>
<dd><p>Reset metric state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.PearsonR.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#PearsonR.result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.PearsonR.result" title="Link to this definition"></a></dt>
<dd><p>Compute PearsonR result from state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.PearsonR.update_state">
<span class="sig-name descname"><span class="pre">update_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#PearsonR.update_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.PearsonR.update_state" title="Link to this definition"></a></dt>
<dd><p>Update metric state for a batch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.metrics.PoissonKL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">PoissonKL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kl_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'poisson_kl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#PoissonKL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.PoissonKL" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LossFunctionWrapper</span></code></p>
<p>Possion decomposition with KL specificity term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kl_weight</strong> (<em>float</em>)  Weight of the KL specificity term.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.metrics.PoissonMultinomial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">PoissonMultinomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'poisson_multinomial'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#PoissonMultinomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.PoissonMultinomial" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LossFunctionWrapper</span></code></p>
<p>Possion decomposition with multinomial specificity term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>total_weight</strong> (<em>float</em>)  Weight of the Poisson total term.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.metrics.R2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">R2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#R2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.R2" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></p>
<p>R2 metric for multi-task data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_targets</strong> (<em>int</em>)  Number of tasks.</p></li>
<li><p><strong>summarize</strong> (<em>bool</em>)  Whether to summarize over all tasks.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.R2.reset_state">
<span class="sig-name descname"><span class="pre">reset_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#R2.reset_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.R2.reset_state" title="Link to this definition"></a></dt>
<dd><p>Reset metric state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.R2.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#R2.result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.R2.result" title="Link to this definition"></a></dt>
<dd><p>Compute R2 result from state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.R2.update_state">
<span class="sig-name descname"><span class="pre">update_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#R2.update_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.R2.update_state" title="Link to this definition"></a></dt>
<dd><p>Update metric state for a batch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.metrics.SeqAUC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">SeqAUC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#SeqAUC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.SeqAUC" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AUC</span></code></p>
<p>AUC metric for multi-task sequence data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>curve</strong> (<em>str</em>)  Metric typeROC or PR.</p></li>
<li><p><strong>summarize</strong> (<em>bool</em>)  Whether to summarize over all tasks.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.SeqAUC.interpolate_pr_auc">
<span class="sig-name descname"><span class="pre">interpolate_pr_auc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#SeqAUC.interpolate_pr_auc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.SeqAUC.interpolate_pr_auc" title="Link to this definition"></a></dt>
<dd><p>Add option to remove summary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.SeqAUC.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#SeqAUC.result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.SeqAUC.result" title="Link to this definition"></a></dt>
<dd><p>Add option to remove summary.
Its not clear why, but these metrics_utils == arent working for tf2.6 on.
Im hacking a solution to compare the values instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.metrics.SeqAUC.update_state">
<span class="sig-name descname"><span class="pre">update_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#SeqAUC.update_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.SeqAUC.update_state" title="Link to this definition"></a></dt>
<dd><p>Flatten sequence length before update.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.metrics.mean_squared_error_udot">
<span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">mean_squared_error_udot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udot_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#mean_squared_error_udot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.mean_squared_error_udot" title="Link to this definition"></a></dt>
<dd><p>Mean squared error with mean-normalized specificity term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>udot_weight</strong>  Weight of the mean-normalized specificity term.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.metrics.poisson">
<span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">poisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#poisson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.poisson" title="Link to this definition"></a></dt>
<dd><p>Poisson loss, without mean reduction.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.metrics.poisson_kl">
<span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">poisson_kl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#poisson_kl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.poisson_kl" title="Link to this definition"></a></dt>
<dd><p>Poisson decomposition with KL specificity term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kl_weight</strong> (<em>float</em>)  Weight of the KL specificity term.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>)  Added small value to avoid log(0).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.metrics.poisson_multinomial">
<span class="sig-prename descclassname"><span class="pre">baskerville.metrics.</span></span><span class="sig-name descname"><span class="pre">poisson_multinomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/metrics.html#poisson_multinomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.metrics.poisson_multinomial" title="Link to this definition"></a></dt>
<dd><p>Possion decomposition with multinomial specificity term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_weight</strong> (<em>float</em>)  Weight of the Poisson total term.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>)  Added small value to avoid log(0).</p></li>
<li><p><strong>rescale</strong> (<em>bool</em>)  Rescale loss after re-weighting.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-baskerville.seqnn">
<span id="baskerville-seqnn-module"></span><h2>baskerville.seqnn module<a class="headerlink" href="#module-baskerville.seqnn" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.seqnn.</span></span><span class="sig-name descname"><span class="pre">SeqNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Sequence neural network model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>dict</em>)  Model specification and parameters.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.append_activation">
<span class="sig-name descname"><span class="pre">append_activation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.append_activation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.append_activation" title="Link to this definition"></a></dt>
<dd><p>add additional activation to convert float16 output to float32, required for mixed precision</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.build_block">
<span class="sig-name descname"><span class="pre">build_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.build_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.build_block" title="Link to this definition"></a></dt>
<dd><p>Construct a SeqNN block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current</strong>  Current Tensor.</p></li>
<li><p><strong>block_params</strong> (<em>dict</em>)  Block parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New current Tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>current</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.build_embed">
<span class="sig-name descname"><span class="pre">build_embed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_layer_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.build_embed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.build_embed" title="Link to this definition"></a></dt>
<dd><p>Build model to embed sequences into specific layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.build_ensemble">
<span class="sig-name descname"><span class="pre">build_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble_rc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.build_ensemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.build_ensemble" title="Link to this definition"></a></dt>
<dd><p>Build ensemble of models computing on augmented input sequences.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_reprs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.build_model" title="Link to this definition"></a></dt>
<dd><p>Build the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.build_sad">
<span class="sig-name descname"><span class="pre">build_sad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.build_sad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.build_sad" title="Link to this definition"></a></dt>
<dd><p>Sum across length axis, in graph.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.build_slice">
<span class="sig-name descname"><span class="pre">build_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.build_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.build_slice" title="Link to this definition"></a></dt>
<dd><p>Slice and/or sum across tasks, in graph.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.downcast">
<span class="sig-name descname"><span class="pre">downcast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.float16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.downcast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.downcast" title="Link to this definition"></a></dt>
<dd><p>Downcast model output type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'poisson'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluate model on SeqDataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.get_bn_layer">
<span class="sig-name descname"><span class="pre">get_bn_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bn_layer_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.get_bn_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.get_bn_layer" title="Link to this definition"></a></dt>
<dd><p>Return specified batch normalization layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.get_conv_layer">
<span class="sig-name descname"><span class="pre">get_conv_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_layer_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.get_conv_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.get_conv_layer" title="Link to this definition"></a></dt>
<dd><p>Return specified convolution layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.get_conv_weights">
<span class="sig-name descname"><span class="pre">get_conv_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_layer_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.get_conv_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.get_conv_weights" title="Link to this definition"></a></dt>
<dd><p>Return kernel weights for specified convolution layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.get_dense_layer">
<span class="sig-name descname"><span class="pre">get_dense_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.get_dense_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.get_dense_layer" title="Link to this definition"></a></dt>
<dd><p>Return specified dense layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.gradients">
<span class="sig-name descname"><span class="pre">gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_slice_denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_mask_denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_soft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">untransform_old</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_untransform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_logodds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_gate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float16'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.gradients" title="Link to this definition"></a></dt>
<dd><p>Compute input gradients for sequences.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.gradients_func">
<span class="sig-name descname"><span class="pre">gradients_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_slice_denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_mask_denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_soft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">untransform_old</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_untransform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_logodds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_gate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.gradients_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.gradients_func" title="Link to this definition"></a></dt>
<dd><p>Compute gradient of the model prediction with respect to the input sequence.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.insert_adapter">
<span class="sig-name descname"><span class="pre">insert_adapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.insert_adapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.insert_adapter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.num_targets">
<span class="sig-name descname"><span class="pre">num_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.num_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.num_targets" title="Link to this definition"></a></dt>
<dd><p>Return number of targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.predict" title="Link to this definition"></a></dt>
<dd><p>Predict targets for SeqDataset, with more options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_data</strong> (<a class="reference internal" href="#baskerville.dataset.SeqDataset" title="baskerville.dataset.SeqDataset"><em>SeqDataset</em></a>)  Dataset to predict on.</p></li>
<li><p><strong>head_i</strong> (<em>int</em>)  Model head index.</p></li>
<li><p><strong>generator</strong> (<em>bool</em>)  Use generator to predict on dataset.</p></li>
<li><p><strong>stream</strong> (<em>bool</em>)  Stream predictions from dataset.</p></li>
<li><p><strong>step</strong> (<em>int</em>)  Step size.</p></li>
<li><p><strong>dtype</strong> (<em>str</em>)  Data type to return.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.predict_transform">
<span class="sig-name descname"><span class="pre">predict_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_1hot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">untransform_old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.predict_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.predict_transform" title="Link to this definition"></a></dt>
<dd><p>Predict a single sequence and transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_1hot</strong> (<em>np.array</em>)  1-hot encoded sequence.</p></li>
<li><p><strong>targets_df</strong> (<em>pd.DataFrame</em>)  Targets dataframe.</p></li>
<li><p><strong>strand_transform</strong> (<em>np.array</em>)  Strand merging transform.</p></li>
<li><p><strong>untransform_old</strong> (<em>bool</em>)  Apply old untransform.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.restore" title="Link to this definition"></a></dt>
<dd><p>Restore weights from saved model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.save" title="Link to this definition"></a></dt>
<dd><p>Save model weights to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_file</strong> (<em>str</em>)  Path to save model weights.</p></li>
<li><p><strong>trunk</strong> (<em>bool</em>)  Save trunk weights only.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.set_defaults">
<span class="sig-name descname"><span class="pre">set_defaults</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.set_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.set_defaults" title="Link to this definition"></a></dt>
<dd><p>Set default parameters.</p>
<p>Only necessary for my bespoke parameters.
Others are best defaulted closer to the source.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.step" title="Link to this definition"></a></dt>
<dd><p>Create new model to step positions across sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<em>int</em>)  Step size.</p></li>
<li><p><strong>head_i</strong> (<em>int</em>)  Model head index.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.seqnn.SeqNN.track_sequence">
<span class="sig-name descname"><span class="pre">track_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/seqnn.html#SeqNN.track_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.seqnn.SeqNN.track_sequence" title="Link to this definition"></a></dt>
<dd><p>Track pooling, striding, and cropping of sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sequence</strong> (<em>tf.Tensor</em>)  Sequence input.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-baskerville.snps">
<span id="baskerville-snps-module"></span><h2>baskerville.snps module<a class="headerlink" href="#module-baskerville.snps" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.snps.GeneSNPCluster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">GeneSNPCluster</span></span><a class="reference internal" href="_modules/baskerville/snps.html#GeneSNPCluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.GeneSNPCluster" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#baskerville.snps.SNPCluster" title="baskerville.snps.SNPCluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNPCluster</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.snps.GeneSNPCluster.add_gene">
<span class="sig-name descname"><span class="pre">add_gene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#GeneSNPCluster.add_gene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.GeneSNPCluster.add_gene" title="Link to this definition"></a></dt>
<dd><p>Add gene to cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.snps.GeneSNPCluster.delimit">
<span class="sig-name descname"><span class="pre">delimit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#GeneSNPCluster.delimit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.GeneSNPCluster.delimit" title="Link to this definition"></a></dt>
<dd><p>Delimit sequence boundaries.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.snps.SNPCluster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">SNPCluster</span></span><a class="reference internal" href="_modules/baskerville/snps.html#SNPCluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.SNPCluster" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.snps.SNPCluster.add_snp">
<span class="sig-name descname"><span class="pre">add_snp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#SNPCluster.add_snp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.SNPCluster.add_snp" title="Link to this definition"></a></dt>
<dd><p>Add SNP to cluster.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.snps.SNPCluster.delimit">
<span class="sig-name descname"><span class="pre">delimit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#SNPCluster.delimit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.SNPCluster.delimit" title="Link to this definition"></a></dt>
<dd><p>Delimit sequence boundaries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.snps.SNPCluster.get_1hots">
<span class="sig-name descname"><span class="pre">get_1hots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genome_open</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#SNPCluster.get_1hots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.SNPCluster.get_1hots" title="Link to this definition"></a></dt>
<dd><p>Get list of one hot coded sequences.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.cluster_genes">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">cluster_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transcriptome</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_pct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#cluster_genes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.cluster_genes" title="Link to this definition"></a></dt>
<dd><p>Cluster genes into regions that will satisfy the required center_pct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transcriptome</strong> (<a class="reference internal" href="#baskerville.gene.Transcriptome" title="baskerville.gene.Transcriptome"><em>Transcriptome</em></a>)  Transcriptome object.</p></li>
<li><p><strong>seq_length</strong> (<em>int</em>)  Sequence length.</p></li>
<li><p><strong>center_pct</strong> (<em>float</em>)  Percent of sequence length to cluster genes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.cluster_snps">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">cluster_snps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_pct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#cluster_snps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.cluster_snps" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Cluster a sorted list of SNPs into regions that will satisfy</dt><dd><p>the required center_pct.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>[</strong><strong>SNP</strong><strong>]</strong> (<em>snps</em>)  List of SNPs.</p></li>
<li><p><strong>seq_len</strong> (<em>int</em>)  Sequence length.</p></li>
<li><p><strong>center_pct</strong> (<em>float</em>)  Percent of sequence length to cluster SNPs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.compute_scores">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">compute_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snp_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#compute_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.compute_scores" title="Link to this definition"></a></dt>
<dd><p>Compute SNP scores from reference and alternative predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_preds</strong> (<em>np.array</em>)  Reference allele predictions.</p></li>
<li><p><strong>alt_preds</strong> (<em>np.array</em>)  Alternative allele predictions.</p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>snp_stats</em>)  List of SAD stats to compute.</p></li>
<li><p><strong>strand_transform</strong> (<em>scipy.sparse</em>)  Strand transform matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.initialize_output_h5">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">initialize_output_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snp_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geneseq_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#initialize_output_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.initialize_output_h5" title="Link to this definition"></a></dt>
<dd><p>Initialize an output HDF5 file for SAD stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>str</em>)  Output directory.</p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>snp_stats</em>)  List of SAD stats to compute.</p></li>
<li><p><strong>[</strong><strong>SNP</strong><strong>]</strong> (<em>snps</em>)  List of SNPs.</p></li>
<li><p><strong>targets_length</strong> (<em>int</em>)  Targets sequence length</p></li>
<li><p><strong>targets_df</strong> (<em>pd.DataFrame</em>)  Targets DataFrame.</p></li>
<li><p><strong>num_shifts</strong> (<em>int</em>)  Number of shifts.</p></li>
<li><p><strong>[</strong><strong>GeneSNPCluster</strong><strong>]</strong> (<em>geneseq_clusters</em>)  Gene sequence clusters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.make_alt_1hot">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">make_alt_1hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_1hot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snp_seq_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_allele</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_allele</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#make_alt_1hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.make_alt_1hot" title="Link to this definition"></a></dt>
<dd><p>Return alternative allele one hot coding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_1hot</strong> (<em>np.array</em>)  Reference allele one hot coding.</p></li>
<li><p><strong>snp_seq_pos</strong> (<em>int</em>)  SNP position in sequence.</p></li>
<li><p><strong>ref_allele</strong> (<em>str</em>)  Reference allele.</p></li>
<li><p><strong>alt_allele</strong> (<em>str</em>)  Alternative allele.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Alternative allele one hot coding.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.make_gene_bedt">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">make_gene_bedt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genesnp_clusters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#make_gene_bedt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.make_gene_bedt" title="Link to this definition"></a></dt>
<dd><p>Make a BedTool object for all gene sequences.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.make_snp_bedt">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">make_snp_bedt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#make_snp_bedt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.make_snp_bedt" title="Link to this definition"></a></dt>
<dd><p>Make a BedTool object for all SNPs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.map_snps_genes">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">map_snps_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genesnp_clusters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#map_snps_genes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.map_snps_genes" title="Link to this definition"></a></dt>
<dd><p>Map SNPs to gene sequences.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.score_gene_snps">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">score_gene_snps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcf_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#score_gene_snps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.score_gene_snps" title="Link to this definition"></a></dt>
<dd><p>Score SNPs in a VCF file with a SeqNN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_file</strong>  Model parameters</p></li>
<li><p><strong>model_file</strong>  Saved model weights</p></li>
<li><p><strong>vcf_file</strong>  VCF</p></li>
</ul>
</dd>
</dl>
<p>:param worker_index
:param options: options from cmd args
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.score_snps">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">score_snps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcf_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#score_snps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.score_snps" title="Link to this definition"></a></dt>
<dd><p>Score SNPs in a VCF file with a SeqNN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_file</strong>  Model parameters</p></li>
<li><p><strong>model_file</strong>  Saved model weights</p></li>
<li><p><strong>vcf_file</strong>  VCF</p></li>
</ul>
</dd>
</dl>
<p>:param worker_index
:param options: options from cmd args
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.stitch_preds">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">stitch_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#stitch_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.stitch_preds" title="Link to this definition"></a></dt>
<dd><p>Stitch indel left and right compensation shifts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>[</strong><strong>np.array</strong><strong>]</strong> (<em>preds</em>)  List of predictions.</p></li>
<li><p><strong>[</strong><strong>int</strong><strong>]</strong> (<em>shifts</em>)  List of shifts.</p></li>
<li><p><strong>pos</strong> (<em>int</em>)  SNP position to stitch at.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.write_pct">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">write_pct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snp_stats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#write_pct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.write_pct" title="Link to this definition"></a></dt>
<dd><p>Compute percentile values for each target and write to HDF5.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores_out</strong> (<em>h5py.File</em>)  Output HDF5 file.</p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>snp_stats</em>)  List of SAD stats to compute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.snps.write_snp">
<span class="sig-prename descclassname"><span class="pre">baskerville.snps.</span></span><span class="sig-name descname"><span class="pre">write_snp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_preds_sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_preds_sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">si</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snp_stats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/snps.html#write_snp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.snps.write_snp" title="Link to this definition"></a></dt>
<dd><p>Write SNP predictions to HDF, assuming the length dimension has
been collapsed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_preds_sum</strong> (<em>np.array</em>)  Reference allele predictions.</p></li>
<li><p><strong>alt_preds_sum</strong> (<em>np.array</em>)  Alternative allele predictions.</p></li>
<li><p><strong>scores_out</strong> (<em>h5py.File</em>)  Output HDF5 file.</p></li>
<li><p><strong>si</strong> (<em>int</em>)  SNP index.</p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>snp_stats</em>)  List of SAD stats to compute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-baskerville.stream">
<span id="baskerville-stream-module"></span><h2>baskerville.stream module<a class="headerlink" href="#module-baskerville.stream" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.stream.PredStreamGen">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.stream.</span></span><span class="sig-name descname"><span class="pre">PredStreamGen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seqs_gen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_seqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/stream.html#PredStreamGen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.stream.PredStreamGen" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interface to acquire predictions via a buffered stream mechanism
rather than getting them all at once and using excessive memory.
Accepts generator and constructs stream batches from it.</p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.stream.PredStreamGen.make_dataset">
<span class="sig-name descname"><span class="pre">make_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/stream.html#PredStreamGen.make_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.stream.PredStreamGen.make_dataset" title="Link to this definition"></a></dt>
<dd><p>Construct Dataset object for this stream chunk.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-baskerville.trainer">
<span id="baskerville-trainer-module"></span><h2>baskerville.trainer module<a class="headerlink" href="#module-baskerville.trainer" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="baskerville.trainer.CheckGradientNA">
<span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">CheckGradientNA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#CheckGradientNA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.CheckGradientNA" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.trainer.Cyclical1LearningRate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">Cyclical1LearningRate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximal_learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Cyclical1LearningRate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Cyclical1LearningRate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Cyclical1LearningRate" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LearningRateSchedule</span></code></p>
<p>A LearningRateSchedule that uses cyclical schedule.
<a class="reference external" href="https://yashuseth.blog/2018/11/26/hyper-parameter-tuning-best-practices-learning-rate-batch-size-momentum-weight-decay/">https://yashuseth.blog/2018/11/26/hyper-parameter-tuning-best-practices-learning-rate-batch-size-momentum-weight-decay/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_learning_rate</strong> (<em>float</em>)  The initial learning rate.</p></li>
<li><p><strong>maximal_learning_rate</strong> (<em>float</em>)  The maximal learning rate after warm up.</p></li>
<li><p><strong>final_learning_rate</strong> (<em>float</em>)  The final learning rate after cycle.</p></li>
<li><p><strong>step_size</strong> (<em>int</em>)  Cycle step size.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>)  The name of the schedule. Defaults to Cyclical1LearningRate.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.Cyclical1LearningRate.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Cyclical1LearningRate.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Cyclical1LearningRate.get_config" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.trainer.EarlyStoppingMin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">EarlyStoppingMin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#EarlyStoppingMin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.EarlyStoppingMin" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStopping</span></code></p>
<p>Stop training when a monitored quantity has stopped improving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>min_epoch</strong>  Minimum number of epochs before considering stopping.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.EarlyStoppingMin.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#EarlyStoppingMin.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.EarlyStoppingMin.on_epoch_end" title="Link to this definition"></a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should
only be called during TRAIN mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong>  Integer, index of epoch.</p></li>
<li><p><strong>logs</strong>  Dict, metric results for this training epoch, and for the
validation epoch if validation is performed. Validation result
keys are prefixed with <cite>val_</cite>. For training epoch, the values of
the <cite>Model</cite>s metrics are returned. Example:
<cite>{loss: 0.2, accuracy: 0.7}</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.trainer.GPUMemoryUsageCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">GPUMemoryUsageCallback</span></span><a class="reference internal" href="_modules/baskerville/trainer.html#GPUMemoryUsageCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.GPUMemoryUsageCallback" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.GPUMemoryUsageCallback.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#GPUMemoryUsageCallback.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.GPUMemoryUsageCallback.on_batch_end" title="Link to this definition"></a></dt>
<dd><p>A backwards compatibility alias for <cite>on_train_batch_end</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.GPUMemoryUsageCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#GPUMemoryUsageCallback.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.GPUMemoryUsageCallback.on_train_begin" title="Link to this definition"></a></dt>
<dd><p>Called at the beginning of training.</p>
<p>Subclasses should override for any actions to run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logs</strong>  Dict. Currently no data is passed to this argument for this
method but that may change in the future.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.trainer.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keras_fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Trainer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Model training class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em>)  Training parameters dictionary.</p></li>
<li><p><strong>train_data</strong>  Dataset object or list of Dataset objects.</p></li>
<li><p><strong>eval_data</strong>  Dataset object or list of Dataset objects.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>)  Output directory name.</p></li>
<li><p><strong>strategy</strong>  tf.distribute.Strategy object.</p></li>
<li><p><strong>num_gpu</strong> (<em>int</em>)  Number of GPUs to use. Default: 1.</p></li>
<li><p><strong>keras_fit</strong> (<em>bool</em>)  Use Keras fit method instead of custom loop.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.Trainer.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqnn_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Trainer.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Trainer.compile" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.Trainer.fit2">
<span class="sig-name descname"><span class="pre">fit2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqnn_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Trainer.fit2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Trainer.fit2" title="Link to this definition"></a></dt>
<dd><p>Train the model using a custom loop for two separate datasets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.Trainer.fit_keras">
<span class="sig-name descname"><span class="pre">fit_keras</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqnn_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Trainer.fit_keras"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Trainer.fit_keras" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.Trainer.fit_tape">
<span class="sig-name descname"><span class="pre">fit_tape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqnn_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Trainer.fit_tape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Trainer.fit_tape" title="Link to this definition"></a></dt>
<dd><p>Train the model using a custom tf.GradientTape loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.Trainer.make_optimizer">
<span class="sig-name descname"><span class="pre">make_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#Trainer.make_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.Trainer.make_optimizer" title="Link to this definition"></a></dt>
<dd><p>Make optimizer object from given parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="baskerville.trainer.WarmUp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">WarmUp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_schedule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#WarmUp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.WarmUp" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LearningRateSchedule</span></code></p>
<p>Applies a warmup schedule on a given learning rate decay schedule.
(h/t HuggingFace.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_learning_rate</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)  Initial learning rate after the warmup
(so this will be the learning rate at the end of the warmup).</p></li>
<li><p><strong>decay_schedule</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Callable</span></code>)  The learning rate or schedule function to
apply after the warmup for the rest of training.</p></li>
<li><p><strong>warmup_steps</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>)  The number of steps for the warmup part of training.</p></li>
<li><p><strong>power</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, <cite>optional</cite>)  Power to use for the polynomial warmup
(defaults is a linear warmup).</p></li>
<li><p><strong>name</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, <cite>optional</cite>)  Optional name prefix for the returned tensors
during the schedule.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="baskerville.trainer.WarmUp.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#WarmUp.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.WarmUp.get_config" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.trainer.adaptive_clip_grad">
<span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">adaptive_clip_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#adaptive_clip_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.adaptive_clip_grad" title="Link to this definition"></a></dt>
<dd><p>Adaptive gradient clipping.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.trainer.compute_norm">
<span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">compute_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#compute_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.compute_norm" title="Link to this definition"></a></dt>
<dd><p>Compute L2 norm of a tensor across an axis.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.trainer.parse_loss">
<span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">parse_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keras_fit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_exp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#parse_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.parse_loss" title="Link to this definition"></a></dt>
<dd><p>Parse loss function from label, strategy, and fitting method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_label</strong> (<em>str</em>)  Loss function label.</p></li>
<li><p><strong>strategy</strong>  tf.distribute.Strategy object.</p></li>
<li><p><strong>keras_fit</strong> (<em>bool</em>)  Use Keras fit method instead of custom loop.</p></li>
<li><p><strong>spec_weight</strong> (<em>float</em>)  Specificity weight for PoissonKL.</p></li>
<li><p><strong>total_weight</strong> (<em>float</em>)  Total weight for PoissionMultinomial.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tf.keras.losses.Loss object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss_fn</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.trainer.safe_next">
<span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">safe_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sleep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#safe_next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.safe_next" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.trainer.unitwise_norm">
<span class="sig-prename descclassname"><span class="pre">baskerville.trainer.</span></span><span class="sig-name descname"><span class="pre">unitwise_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/trainer.html#unitwise_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.trainer.unitwise_norm" title="Link to this definition"></a></dt>
<dd><p>Compute L2 norm of a tensor across its last dimension.</p>
</dd></dl>

</section>
<section id="module-baskerville.transfer">
<span id="baskerville-transfer-module"></span><h2>baskerville.transfer module<a class="headerlink" href="#module-baskerville.transfer" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.add_houlsby">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">add_houlsby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#add_houlsby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.add_houlsby" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.add_houlsby_se">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">add_houlsby_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">houlsby_latent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#add_houlsby_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.add_houlsby_se" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.add_ia3">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">add_ia3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_pair</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#add_ia3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.add_ia3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.add_locon">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">add_locon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strand_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#add_locon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.add_locon" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.add_lora">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">add_lora</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#add_lora"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.add_lora" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.add_lora_conv">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">add_lora_conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#add_lora_conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.add_lora_conv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.keras2dict">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">keras2dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#keras2dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.keras2dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.locon_increment">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">locon_increment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#locon_increment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.locon_increment" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.lora_increment">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">lora_increment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#lora_increment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.lora_increment" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.merge_ia3">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">merge_ia3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ia3_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#merge_ia3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.merge_ia3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.merge_locon">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">merge_locon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locon_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#merge_locon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.merge_locon" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.merge_lora">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">merge_lora</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#merge_lora"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.merge_lora" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.merge_lora_layer">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">merge_lora_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lora_layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#merge_lora_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.merge_lora_layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.modify_json">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">modify_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_json</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_json</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#modify_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.modify_json" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.param_count">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">param_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#param_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.param_count" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.param_summary">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">param_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#param_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.param_summary" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.transfer.var_reorder">
<span class="sig-prename descclassname"><span class="pre">baskerville.transfer.</span></span><span class="sig-name descname"><span class="pre">var_reorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_h5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/transfer.html#var_reorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.transfer.var_reorder" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-baskerville.vcf">
<span id="baskerville-vcf-module"></span><h2>baskerville.vcf module<a class="headerlink" href="#module-baskerville.vcf" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="baskerville.vcf.SNP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">SNP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf_line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#SNP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.SNP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represent SNPs read in from a VCF file</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="baskerville.vcf.SNP.vcf_line">
<span class="sig-name descname"><span class="pre">vcf_line</span></span><a class="headerlink" href="#baskerville.vcf.SNP.vcf_line" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.vcf.SNP.flip_alleles">
<span class="sig-name descname"><span class="pre">flip_alleles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#SNP.flip_alleles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.SNP.flip_alleles" title="Link to this definition"></a></dt>
<dd><p>Flip reference and first alt allele.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.vcf.SNP.get_alleles">
<span class="sig-name descname"><span class="pre">get_alleles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#SNP.get_alleles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.SNP.get_alleles" title="Link to this definition"></a></dt>
<dd><p>Return a list of all alleles</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.vcf.SNP.indel_size">
<span class="sig-name descname"><span class="pre">indel_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#SNP.indel_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.SNP.indel_size" title="Link to this definition"></a></dt>
<dd><p>Return the size of the indel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="baskerville.vcf.SNP.longest_alt">
<span class="sig-name descname"><span class="pre">longest_alt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#SNP.longest_alt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.SNP.longest_alt" title="Link to this definition"></a></dt>
<dd><p>Return the longest alt allele.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.cap_allele">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">cap_allele</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allele</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#cap_allele"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.cap_allele" title="Link to this definition"></a></dt>
<dd><p>Cap the length of an allele in the figures.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.dna_length_1hot">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">dna_length_1hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#dna_length_1hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.dna_length_1hot" title="Link to this definition"></a></dt>
<dd><p>Adjust the sequence length and compute
a 1hot coding.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.intersect_seqs_snps">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">intersect_seqs_snps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vision_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#intersect_seqs_snps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.intersect_seqs_snps" title="Link to this definition"></a></dt>
<dd><p>Intersect a VCF file with a list of sequence coordinates.</p>
<dl class="simple">
<dt>In</dt><dd><p>vcf_file:
seqs: list of objects w/ chrom, start, end
vision_p: proportion of sequences visible to center genes.</p>
</dd>
<dt>Out</dt><dd><p>seqs_snps: list of list mapping segment indexes to overlapping SNP indexes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.intersect_snps_seqs">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">intersect_snps_seqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vision_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#intersect_snps_seqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.intersect_snps_seqs" title="Link to this definition"></a></dt>
<dd><p>Intersect a VCF file with a list of sequence coordinates.</p>
<dl class="simple">
<dt>In</dt><dd><p>vcf_file:
seq_coords: list of sequence coordinates
vision_p: proportion of sequences visible to center genes.</p>
</dd>
<dt>Out</dt><dd><p>snp_segs: list of list mapping SNP indexes to overlapping sequence indexes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.snp_seq1">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">snp_seq1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genome_open</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#snp_seq1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.snp_seq1" title="Link to this definition"></a></dt>
<dd><p>Produce one hot coded sequences for a SNP.</p>
<dl class="simple">
<dt>Attrs:</dt><dd><p>snp [SNP] :
seq_len (int) : sequence length to code
genome_open (File) : open genome FASTA file</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of one hot coded sequences surrounding the
SNP</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>seq_vecs_list [array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.snps2_seq1">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">snps2_seq1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genome1_fasta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genome2_fasta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_seqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#snps2_seq1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.snps2_seq1" title="Link to this definition"></a></dt>
<dd><p>Produce an array of one hot coded sequences for a list of SNPs.</p>
<dl class="simple">
<dt>Attrs:</dt><dd><p>snps [SNP] : list of SNPs
seq_len (int) : sequence length to code
genome_fasta (str) : major allele genome FASTA file
genome2_fasta (str) : minor allele genome FASTA file</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>one hot coded sequences surrounding the SNPs
seq_headers [str] : headers for sequences
seq_snps [SNP] : list of used SNPs</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>seq_vecs (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.snps_seq1">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">snps_seq1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genome_fasta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_seqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#snps_seq1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.snps_seq1" title="Link to this definition"></a></dt>
<dd><p>Produce an array of one hot coded sequences for a list of SNPs.</p>
<dl class="simple">
<dt>Attrs:</dt><dd><p>snps [SNP] : list of SNPs
seq_len (int) : sequence length to code
genome_fasta (str) : genome FASTA file</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>one hot coded sequences surrounding the SNPs
seq_headers [str] : headers for sequences
seq_snps [SNP] : list of used SNPs</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>seq_vecs (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.vcf_count">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">vcf_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#vcf_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.vcf_count" title="Link to this definition"></a></dt>
<dd><p>Count SNPs in a VCF file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.vcf_snps">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">vcf_snps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_ref_fasta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#vcf_snps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.vcf_snps" title="Link to this definition"></a></dt>
<dd><p>Load SNPs from a VCF file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="baskerville.vcf.vcf_sort">
<span class="sig-prename descclassname"><span class="pre">baskerville.vcf.</span></span><span class="sig-name descname"><span class="pre">vcf_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baskerville/vcf.html#vcf_sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#baskerville.vcf.vcf_sort" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-baskerville">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-baskerville" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="baskerville documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="baskerville.helpers.html" class="btn btn-neutral float-right" title="baskerville.helpers package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, David Kelly.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>